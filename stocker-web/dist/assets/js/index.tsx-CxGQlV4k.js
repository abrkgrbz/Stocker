var _=Object.defineProperty,W=Object.defineProperties;var X=Object.getOwnPropertyDescriptors;var $=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var F=(r,s,n)=>s in r?_(r,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[s]=n,y=(r,s)=>{for(var n in s||(s={}))J.call(s,n)&&F(r,n,s[n]);if($)for(var n of $(s))Q.call(s,n)&&F(r,n,s[n]);return r},I=(r,s)=>W(r,X(s));var S=(r,s,n)=>new Promise((A,v)=>{var l=d=>{try{x(n.next(d))}catch(h){v(h)}},p=d=>{try{x(n.throw(d))}catch(h){v(h)}},x=d=>d.done?A(d.value):Promise.resolve(d.value).then(l,p);x((n=n.apply(r,s)).next())});import{am as j,j as e,M as O,N as f,O as k,aT as b,p as q,_ as M,a5 as H,b4 as C,ah as U,b7 as ee,a_ as B,bf as te,aW as ae,b8 as se,S as T,v as u,aj as P,bk as Y,b1 as R,b6 as z,bl as ne,aY as ie,aV as re,B as le,A as oe,aF as ce,T as de,D as ue,bc as me,bm as c,b2 as xe,b5 as he}from"./chunk-CQugYT0Y.js";import{u as je,r as g}from"./chunk-a6Wk6XzP.js";import{i as m}from"./chunk-8twwa0Xh.js";import"./chunk-B1KqMBAo.js";import"./chunk-CX9aqCgN.js";const{RangePicker:fe}=te,{Option:D}=B,Te=()=>{const r=je(),[s,n]=g.useState([]),[A,v]=g.useState(!1),[l,p]=g.useState({pageNumber:1,pageSize:20}),[x,d]=g.useState([]),[h,G]=g.useState({total:0,paid:0,pending:0,overdue:0});g.useEffect(()=>{w()},[l]);const w=()=>S(null,null,function*(){try{v(!0);let a=[...[{id:"1",invoiceNumber:"INV-2024-001",customerId:"1",customerName:"ABC Teknoloji A.Ş.",invoiceDate:"2024-01-15T00:00:00",dueDate:"2024-02-15T00:00:00",subTotal:1e4,taxAmount:1800,discountAmount:500,totalAmount:11300,currency:"TRY",status:"Paid",paidDate:"2024-02-10T00:00:00",paymentMethod:"BankTransfer",items:[],createdAt:"2024-01-15T00:00:00"},{id:"2",invoiceNumber:"INV-2024-002",customerId:"2",customerName:"XYZ Yazılım Ltd.",invoiceDate:"2024-01-20T00:00:00",dueDate:"2024-02-20T00:00:00",subTotal:25e3,taxAmount:4500,discountAmount:1e3,totalAmount:28500,currency:"TRY",status:"Overdue",items:[],createdAt:"2024-01-20T00:00:00"},{id:"3",invoiceNumber:"INV-2024-003",customerId:"3",customerName:"Demo Şirketi",invoiceDate:"2024-02-01T00:00:00",dueDate:"2024-03-01T00:00:00",subTotal:15e3,taxAmount:2700,discountAmount:0,totalAmount:17700,currency:"TRY",status:"Sent",items:[],createdAt:"2024-02-01T00:00:00"},{id:"4",invoiceNumber:"INV-2024-004",customerId:"1",customerName:"ABC Teknoloji A.Ş.",invoiceDate:"2024-02-05T00:00:00",dueDate:"2024-03-05T00:00:00",subTotal:8e3,taxAmount:1440,discountAmount:400,totalAmount:9040,currency:"TRY",status:"Draft",items:[],createdAt:"2024-02-05T00:00:00"},{id:"5",invoiceNumber:"INV-2024-005",customerId:"2",customerName:"XYZ Yazılım Ltd.",invoiceDate:"2024-01-10T00:00:00",dueDate:"2024-02-10T00:00:00",subTotal:12e3,taxAmount:2160,discountAmount:600,totalAmount:13560,currency:"TRY",status:"Cancelled",items:[],createdAt:"2024-01-10T00:00:00"}]];l.status&&(a=a.filter(i=>i.status===l.status)),n(a),V(a)}catch(t){j.error("Faturalar yüklenirken hata oluştu")}finally{v(!1)}}),V=t=>{const a=t.reduce((i,o)=>(i.total+=o.totalAmount,o.status==="Paid"?i.paid+=o.totalAmount:o.status==="Sent"||o.status==="Draft"?i.pending+=o.totalAmount:o.status==="Overdue"&&(i.overdue+=o.totalAmount),i),{total:0,paid:0,pending:0,overdue:0});G(a)},N=(t,a)=>S(null,null,function*(){try{switch(a){case"send":yield m.sendInvoice(t.id),j.success("Fatura gönderildi");break;case"markPaid":yield m.markAsPaid(t.id,{paymentDate:new Date().toISOString(),paymentMethod:"BankTransfer"}),j.success("Fatura ödendi olarak işaretlendi");break;case"cancel":yield m.cancelInvoice(t.id,"Müşteri talebi"),j.success("Fatura iptal edildi");break}w()}catch(i){j.error("İşlem başarısız oldu")}}),L=t=>S(null,null,function*(){try{yield m.deleteInvoice(t),j.success("Fatura silindi"),w()}catch(a){j.error("Silme işlemi başarısız oldu")}}),E=t=>e.jsxs(c,{children:[e.jsx(c.Item,{icon:e.jsx(xe,{}),onClick:()=>r(`/invoices/${t.id}`),children:"Görüntüle"},"view"),e.jsx(c.Item,{icon:e.jsx(he,{}),onClick:()=>r(`/invoices/${t.id}/edit`),children:"Düzenle"},"edit"),e.jsx(c.Divider,{}),t.status==="Draft"&&e.jsx(c.Item,{icon:e.jsx(P,{}),onClick:()=>N(t,"send"),children:"Gönder"},"send"),t.status==="Sent"&&e.jsx(c.Item,{icon:e.jsx(M,{}),onClick:()=>N(t,"markPaid"),children:"Ödendi İşaretle"},"markPaid"),e.jsx(c.Item,{icon:e.jsx(Y,{}),children:"Yazdır"},"print"),e.jsx(c.Item,{icon:e.jsx(R,{}),children:"PDF İndir"},"download"),e.jsx(c.Divider,{}),t.status==="Draft"&&e.jsx(c.Item,{icon:e.jsx(z,{}),danger:!0,onClick:()=>L(t.id),children:"Sil"},"delete"),(t.status==="Sent"||t.status==="Overdue")&&e.jsx(c.Item,{icon:e.jsx(C,{}),danger:!0,onClick:()=>N(t,"cancel"),children:"İptal Et"},"cancel")]}),K=[{title:"Fatura No",dataIndex:"invoiceNumber",key:"invoiceNumber",fixed:"left",width:120,render:(t,a)=>e.jsx(u,{type:"link",onClick:()=>r(`/invoices/${a.id}`),children:t})},{title:"Müşteri",dataIndex:"customerName",key:"customerName",width:200,render:t=>e.jsxs(T,{children:[e.jsx(oe,{style:{backgroundColor:"#87d068"},children:(t==null?void 0:t.charAt(0))||"M"}),e.jsx("span",{children:t||"Müşteri Adı"})]})},{title:"Fatura Tarihi",dataIndex:"invoiceDate",key:"invoiceDate",width:120,render:t=>new Date(t).toLocaleDateString("tr-TR")},{title:"Vade Tarihi",dataIndex:"dueDate",key:"dueDate",width:120,render:(t,a)=>{const i=m.calculateDaysOverdue(t),o=a.status==="Overdue"||a.status==="Sent"&&i>0;return e.jsxs(T,{children:[e.jsx("span",{style:{color:o?"#ff4d4f":void 0},children:new Date(t).toLocaleDateString("tr-TR")}),o&&e.jsx(ce,{title:`${Math.abs(i)} gün gecikme`,children:e.jsx(C,{style:{color:"#ff4d4f"}})})]})}},{title:"Tutar",dataIndex:"totalAmount",key:"totalAmount",width:150,align:"right",render:(t,a)=>e.jsx("span",{style:{fontWeight:600},children:m.formatCurrency(t,a.currency)}),sorter:(t,a)=>t.totalAmount-a.totalAmount},{title:"Durum",dataIndex:"status",key:"status",width:120,render:t=>{const i={Draft:{color:"default",text:"Taslak"},Sent:{color:"processing",text:"Gönderildi"},Paid:{color:"success",text:"Ödendi"},Overdue:{color:"error",text:"Gecikmiş"},Cancelled:{color:"warning",text:"İptal"}}[t]||{color:"default",text:t};return e.jsx(de,{color:i.color,children:i.text})},filters:[{text:"Taslak",value:"Draft"},{text:"Gönderildi",value:"Sent"},{text:"Ödendi",value:"Paid"},{text:"Gecikmiş",value:"Overdue"},{text:"İptal",value:"Cancelled"}]},{title:"İşlemler",key:"actions",fixed:"right",width:100,render:(t,a)=>e.jsx(ue,{overlay:E(a),trigger:["click"],children:e.jsx(u,{icon:e.jsx(me,{})})})}],Z={selectedRowKeys:x,onChange:t=>d(t)};return e.jsxs("div",{className:"invoice-list",children:[e.jsxs(O,{gutter:16,className:"statistics-row",children:[e.jsx(f,{xs:24,sm:12,lg:6,children:e.jsx(k,{children:e.jsx(b,{title:"Toplam Fatura",value:s.length,prefix:e.jsx(q,{}),valueStyle:{color:"#1890ff"}})})}),e.jsx(f,{xs:24,sm:12,lg:6,children:e.jsx(k,{children:e.jsx(b,{title:"Ödenen",value:h.paid,prefix:e.jsx(M,{}),valueStyle:{color:"#52c41a"},formatter:t=>m.formatCurrency(t)})})}),e.jsx(f,{xs:24,sm:12,lg:6,children:e.jsx(k,{children:e.jsx(b,{title:"Bekleyen",value:h.pending,prefix:e.jsx(H,{}),valueStyle:{color:"#faad14"},formatter:t=>m.formatCurrency(t)})})}),e.jsx(f,{xs:24,sm:12,lg:6,children:e.jsx(k,{children:e.jsx(b,{title:"Gecikmiş",value:h.overdue,prefix:e.jsx(C,{}),valueStyle:{color:"#ff4d4f"},formatter:t=>m.formatCurrency(t)})})})]}),e.jsxs(k,{title:e.jsxs(T,{children:[e.jsx(re,{}),e.jsx("span",{children:"Faturalar"}),e.jsx(le,{count:s.length,showZero:!0})]}),extra:e.jsxs(T,{children:[e.jsx(u,{icon:e.jsx(ne,{}),children:"Filtrele"}),e.jsx(u,{icon:e.jsx(R,{}),children:"Dışa Aktar"}),e.jsx(u,{type:"primary",icon:e.jsx(ie,{}),onClick:()=>r("/invoices/new"),children:"Yeni Fatura"})]}),children:[e.jsxs(O,{gutter:16,className:"filter-row",children:[e.jsx(f,{xs:24,sm:12,lg:6,children:e.jsx(U,{placeholder:"Fatura no veya müşteri ara...",prefix:e.jsx(ee,{}),onChange:t=>p(I(y({},l),{pageNumber:1}))})}),e.jsx(f,{xs:24,sm:12,lg:6,children:e.jsxs(B,{placeholder:"Durum seçin",style:{width:"100%"},allowClear:!0,onChange:t=>p(I(y({},l),{status:t,pageNumber:1})),children:[e.jsx(D,{value:"Draft",children:"Taslak"}),e.jsx(D,{value:"Sent",children:"Gönderildi"}),e.jsx(D,{value:"Paid",children:"Ödendi"}),e.jsx(D,{value:"Overdue",children:"Gecikmiş"}),e.jsx(D,{value:"Cancelled",children:"İptal"})]})}),e.jsx(f,{xs:24,sm:12,lg:8,children:e.jsx(fe,{style:{width:"100%"},placeholder:["Başlangıç","Bitiş"],onChange:t=>{var a,i;t&&p(I(y({},l),{startDate:(a=t[0])==null?void 0:a.toISOString(),endDate:(i=t[1])==null?void 0:i.toISOString(),pageNumber:1}))}})})]}),e.jsx(ae,{rowSelection:Z,columns:K,dataSource:s,rowKey:"id",loading:A,scroll:{x:1200},pagination:{current:l.pageNumber,pageSize:l.pageSize,total:s.length*2,showSizeChanger:!0,showQuickJumper:!0,showTotal:t=>`Toplam ${t} fatura`,onChange:(t,a)=>{p(I(y({},l),{pageNumber:t,pageSize:a}))}},locale:{emptyText:e.jsx(se,{description:"Fatura bulunamadı"})}}),x.length>0&&e.jsx("div",{className:"bulk-actions",children:e.jsxs(T,{children:[e.jsxs("span",{children:[x.length," fatura seçildi"]}),e.jsx(u,{icon:e.jsx(P,{}),children:"Toplu Gönder"}),e.jsx(u,{icon:e.jsx(Y,{}),children:"Toplu Yazdır"}),e.jsx(u,{icon:e.jsx(R,{}),children:"PDF İndir"}),e.jsx(u,{danger:!0,icon:e.jsx(z,{}),children:"Sil"})]})})]})]})};export{Te as default};
