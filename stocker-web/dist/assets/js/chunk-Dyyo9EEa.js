var t=Object.defineProperty,n=Object.defineProperties,i=Object.getOwnPropertyDescriptors,e=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,l=(n,i,e)=>i in n?t(n,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[i]=e,s=(t,n,i)=>l(t,"symbol"!=typeof n?n+"":n,i),c=(t,n,i)=>new Promise((e,o)=>{var a=t=>{try{s(i.next(t))}catch(n){o(n)}},l=t=>{try{s(i.throw(t))}catch(n){o(n)}},s=t=>t.done?e(t.value):Promise.resolve(t.value).then(a,l);s((i=i.apply(t,n)).next())});import{r}from"./chunk-nBmrMGrr.js";import{A as d}from"../index-C40P1pGL.js";import{H as h,a as u,b as C,L as m}from"./chunk-FkXcRIdw.js";const k=new class{constructor(){s(this,"validationConnection",null),s(this,"notificationConnection",null),s(this,"baseUrl",d)}startValidationConnection(){return c(this,null,function*(){var t;if((null==(t=this.validationConnection)?void 0:t.state)===h.Connected)return;const n=localStorage.getItem("X-Tenant-Id")||"master";this.validationConnection=(new u).withUrl(`${this.baseUrl}/hubs/validation`,{transport:C.WebSockets|C.ServerSentEvents|C.LongPolling,withCredentials:!1,headers:{"X-Tenant-Id":n,"X-Bypass-Rate-Limit":"true"}}).withAutomaticReconnect([2e3,5e3,1e4,3e4]).configureLogging(m.Debug).build(),this.validationConnection.onreconnecting(t=>{}),this.validationConnection.onreconnected(t=>{}),this.validationConnection.onclose(t=>{});try{yield this.validationConnection.start()}catch(i){throw i}})}startNotificationConnection(t){return c(this,null,function*(){var s;if((null==(s=this.notificationConnection)?void 0:s.state)===h.Connected)return;const c={withCredentials:!0};var r,d;t&&(c.accessTokenFactory=()=>t),this.notificationConnection=(new u).withUrl(`${this.baseUrl}/hubs/notification`,(r=((t,n)=>{for(var i in n||(n={}))o.call(n,i)&&l(t,i,n[i]);if(e)for(var i of e(n))a.call(n,i)&&l(t,i,n[i]);return t})({},c),d={transport:C.WebSockets|C.ServerSentEvents|C.LongPolling},n(r,i(d)))).withAutomaticReconnect([2e3,5e3,1e4,3e4]).configureLogging(m.Debug).build(),this.notificationConnection.onreconnecting(()=>{}),this.notificationConnection.onreconnected(()=>{}),this.notificationConnection.onclose(()=>{});try{yield this.notificationConnection.start()}catch(k){throw k}})}validateEmail(t){return c(this,null,function*(){return this.validationConnection&&this.validationConnection.state===h.Connected||(yield this.startValidationConnection()),this.validationConnection.invoke("ValidateEmail",t)})}onEmailValidated(t){var n;null==(n=this.validationConnection)||n.on("EmailValidated",t)}checkPasswordStrength(t){return c(this,null,function*(){return this.validationConnection&&this.validationConnection.state===h.Connected||(yield this.startValidationConnection()),this.validationConnection.invoke("CheckPasswordStrength",t)})}onPasswordStrengthChecked(t){var n;null==(n=this.validationConnection)||n.on("PasswordStrengthChecked",t)}checkDomain(t){return c(this,null,function*(){return this.validationConnection&&this.validationConnection.state===h.Connected||(yield this.startValidationConnection()),this.validationConnection.invoke("CheckDomain",t)})}onDomainChecked(t){var n;null==(n=this.validationConnection)||n.on("DomainChecked",t)}validatePhone(t,n="TR"){return c(this,null,function*(){return this.validationConnection&&this.validationConnection.state===h.Connected||(yield this.startValidationConnection()),this.validationConnection.invoke("ValidatePhone",t,n)})}onPhoneValidated(t){var n;null==(n=this.validationConnection)||n.on("PhoneValidated",t)}checkCompanyName(t){return c(this,null,function*(){return this.validationConnection&&this.validationConnection.state===h.Connected||(yield this.startValidationConnection()),this.validationConnection.invoke("CheckCompanyName",t)})}onCompanyNameChecked(t){var n;null==(n=this.validationConnection)||n.on("CompanyNameChecked",t)}validateIdentity(t){return c(this,null,function*(){var n,i;try{this.validationConnection&&this.validationConnection.state===h.Connected||(yield this.startValidationConnection()),yield this.validationConnection.invoke("ValidateIdentity",t)}catch(e){if(!(null==(n=null==e?void 0:e.message)?void 0:n.includes("disconnect"))&&!(null==(i=null==e?void 0:e.message)?void 0:i.includes("close")))throw e;try{yield this.startValidationConnection(),yield this.validationConnection.invoke("ValidateIdentity",t)}catch(o){throw o}}})}onIdentityValidated(t){var n;null==(n=this.validationConnection)||n.on("IdentityValidated",t)}onNotificationReceived(t){var n;null==(n=this.notificationConnection)||n.on("ReceiveNotification",t)}onConnected(t){var n,i;null==(n=this.validationConnection)||n.on("Connected",t),null==(i=this.notificationConnection)||i.on("Connected",t)}onValidationError(t){var n;null==(n=this.validationConnection)||n.on("ValidationError",t)}stopValidationConnection(){return c(this,null,function*(){this.validationConnection&&(yield this.validationConnection.stop(),this.validationConnection=null)})}stopNotificationConnection(){return c(this,null,function*(){this.notificationConnection&&(yield this.notificationConnection.stop(),this.notificationConnection=null)})}stopAllConnections(){return c(this,null,function*(){yield this.stopValidationConnection(),yield this.stopNotificationConnection()})}};const v=new class{constructor(){s(this,"emailCallbacks",[]),s(this,"passwordCallbacks",[]),s(this,"domainCallbacks",[]),s(this,"phoneCallbacks",[]),s(this,"companyCallbacks",[]),s(this,"identityCallbacks",[]),s(this,"notificationCallbacks",[]),s(this,"connectedCallbacks",[]),s(this,"errorCallbacks",[]),s(this,"validateIdentity",t=>c(this,null,function*(){setTimeout(()=>{const n=t.replace(/\D/g,"");let i=!1,e="",o="";11===n.length?(e="TCKimlik",i=this.validateTCKimlikNo(n),o=i?"TC Kimlik numarası geçerli":"Geçersiz TC Kimlik numarası"):10===n.length?(e="VergiNo",i=this.validateVergiNo(n),o=i?"Vergi numarası geçerli":"Geçersiz Vergi numarası"):o="Kimlik/Vergi numarası 10 veya 11 haneli olmalıdır";const a={isValid:i,message:o,details:{numberType:e,formattedNumber:n,length:n.length.toString()}};this.identityCallbacks.forEach(t=>t(a))},400)}))}startValidationConnection(){return c(this,null,function*(){yield new Promise(t=>setTimeout(t,500)),this.connectedCallbacks.forEach(t=>t({connectionId:"mock-connection-id"}))})}startNotificationConnection(t){return c(this,null,function*(){yield new Promise(t=>setTimeout(t,500)),this.connectedCallbacks.forEach(n=>n({connectionId:"mock-notification-id",token:t}))})}validateEmail(t){return c(this,null,function*(){setTimeout(()=>{const n=/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t),i={isValid:n,message:n?"Email adresi geçerli":"Geçersiz email formatı",details:{format:n?"valid":"invalid",domain:t.split("@")[1]||"",suggestion:n||t.includes("@")?"":"@ işareti eksik"}};this.emailCallbacks.forEach(t=>t(i))},300)})}onEmailValidated(t){this.emailCallbacks.push(t)}checkPasswordStrength(t){return c(this,null,function*(){setTimeout(()=>{let n=0;const i=[];t.length>=8?n++:i.push("En az 8 karakter kullanın"),t.length>=12&&n++,/[A-Z]/.test(t)?n++:i.push("Büyük harf ekleyin"),/[a-z]/.test(t)?n++:i.push("Küçük harf ekleyin"),/\d/.test(t)?n++:i.push("Rakam ekleyin"),/[!@#$%^&*(),.?":{}|<>]/.test(t)?n++:i.push("Özel karakter ekleyin (!@#$%^&*)");const e=Math.min(Math.floor(n/1.5),4),o={score:Math.min(n,5),level:["VeryWeak","Weak","Fair","Strong","VeryStrong"][e],color:["#ff4d4f","#faad14","#fadb14","#52c41a","#389e0d"][e],suggestions:i};this.passwordCallbacks.forEach(t=>t(o))},200)})}onPasswordStrengthChecked(t){this.passwordCallbacks.push(t)}checkDomain(t){return c(this,null,function*(){setTimeout(()=>{const n=!["test.stocker.app","demo.stocker.app","example.stocker.app"].includes(t.toLowerCase()),i=t.split(".")[0],e={isAvailable:n,message:n?"Domain kullanılabilir":"Bu domain zaten kullanılıyor",suggestions:n?[]:[`${i}1.stocker.app`,`${i}-company.stocker.app`,`${i}2024.stocker.app`]};this.domainCallbacks.forEach(t=>t(e))},400)})}onDomainChecked(t){this.domainCallbacks.push(t)}validatePhone(t,n="TR"){return c(this,null,function*(){setTimeout(()=>{const i=t.replace(/\D/g,""),e="TR"===n?/^(90)?5\d{9}$/.test(i)||/^5\d{9}$/.test(i):i.length>=10,o={isValid:e,message:e?"Telefon numarası geçerli":"Geçersiz telefon numarası formatı",details:{countryCode:n,format:e?"valid":"invalid",suggestion:"TR"!==n||e?"":"Türkiye telefon numarası 5XX XXX XX XX formatında olmalı"}};this.phoneCallbacks.forEach(t=>t(o))},300)})}onPhoneValidated(t){this.phoneCallbacks.push(t)}checkCompanyName(t){return c(this,null,function*(){setTimeout(()=>{const n=["ABC Teknoloji","XYZ Yazılım","Test Company"],i=t.toLowerCase(),e=["admin","system","test","root","superuser"].some(t=>i.includes(t)),o=!n.some(t=>t.toLowerCase()===i),a=!e&&t.length>=3;let l="",s={};e?(l="Şirket adı kısıtlı kelimeler içeriyor",s.restriction="Admin, System, Test gibi kelimeler kullanılamaz"):o?l=t.length<3?"Şirket adı en az 3 karakter olmalıdır":"Şirket adı kullanılabilir":(l="Bu şirket adı zaten kayıtlı",s.suggestion="Şirket adına bir numara veya ayırt edici kelime ekleyin");const c={isValid:a,isUnique:o,containsRestrictedWords:e,message:l,similarNames:o?[]:n.filter(t=>t.toLowerCase().includes(i.substring(0,3))),details:s};this.companyCallbacks.forEach(t=>t(c))},350)})}onCompanyNameChecked(t){this.companyCallbacks.push(t)}validateTCKimlikNo(t){if(11!==t.length)return!1;if(!/^\d{11}$/.test(t))return!1;if("0"===t[0])return!1;const n=t.split("").map(Number);let i=(7*(n[0]+n[2]+n[4]+n[6]+n[8])-(n[1]+n[3]+n[5]+n[7]))%10;if(i<0&&(i+=10),n[9]!==i)return!1;const e=n.slice(0,10).reduce((t,n)=>t+n,0)%10;return n[10]===e}validateVergiNo(t){if(10!==t.length)return!1;if(!/^\d{10}$/.test(t))return!1;const n=t.split("").map(Number);let i=(n[0]+9)%10,e=2*i%9;0!==i&&0===e&&(e=9);let o=(n[1]+8)%10,a=4*o%9;0!==o&&0===a&&(a=9);let l=(n[2]+7)%10,s=8*l%9;0!==l&&0===s&&(s=9);let c=(n[3]+6)%10,r=16*c%9;0!==c&&0===r&&(r=9);let d=(n[4]+5)%10,h=32*d%9;0!==d&&0===h&&(h=9);let u=(n[5]+4)%10,C=64*u%9;0!==u&&0===C&&(C=9);let m=(n[6]+3)%10,k=128*m%9;0!==m&&0===k&&(k=9);let v=(n[7]+2)%10,f=256*v%9;0!==v&&0===f&&(f=9);let y=(n[8]+1)%10,p=512*y%9;0!==y&&0===p&&(p=9);const g=(10-(e+a+s+r+h+C+k+f+p)%10)%10;return n[9]===g}onIdentityValidated(t){this.identityCallbacks.push(t)}onNotificationReceived(t){this.notificationCallbacks.push(t),setTimeout(()=>{t({id:"mock-1",title:"Hoş Geldiniz",message:"SignalR Mock Service aktif",type:"Info",priority:"Normal",createdAt:new Date,icon:"info"})},2e3)}onConnected(t){this.connectedCallbacks.push(t)}onValidationError(t){this.errorCallbacks.push(t)}stopValidationConnection(){return c(this,null,function*(){this.emailCallbacks=[],this.passwordCallbacks=[],this.domainCallbacks=[],this.phoneCallbacks=[],this.companyCallbacks=[],this.identityCallbacks=[],this.connectedCallbacks=[],this.errorCallbacks=[]})}stopNotificationConnection(){return c(this,null,function*(){this.notificationCallbacks=[]})}stopAllConnections(){return c(this,null,function*(){yield this.stopValidationConnection(),yield this.stopNotificationConnection()})}},f=()=>{const[t,n]=r.useState(!1),[i,e]=r.useState(null),[o,a]=r.useState(null),[l,s]=r.useState(null),[d,h]=r.useState(null),[u,C]=r.useState(null),[m,f]=r.useState(null),[y,p]=r.useState(null),[g,b]=r.useState(!1);r.useEffect(()=>{let t=!0,i=!1;return c(null,null,function*(){if(i)return;i=!0;const o=g?v:k;try{g?yield v.startValidationConnection():yield k.startValidationConnection(),t&&n(!0),o.onEmailValidated(t=>{e(t)}),o.onPasswordStrengthChecked(t=>{a(t)}),o.onDomainChecked(t=>{s(t)}),o.onPhoneValidated(t=>{h(t)}),o.onCompanyNameChecked(t=>{C(t)}),o.onIdentityValidated(t=>{f(t)}),o.onValidationError(t=>{p(t)}),o.onConnected(()=>{})}catch(l){g?(p("Failed to connect to validation service"),n(!1)):(b(!0),p("Using mock validation service (API not available)"))}}),()=>{t=!1,g?v.stopValidationConnection():k.stopValidationConnection()}},[]);const V=g?v:k;return{isConnected:t,emailValidation:i,passwordStrength:o,domainCheck:l,phoneValidation:d,companyNameCheck:u,identityValidation:m,error:y,validateEmail:r.useCallback(t=>c(null,null,function*(){p(null),e(null);try{yield V.validateEmail(t)}catch(n){p("Failed to validate email")}}),[V]),checkPasswordStrength:r.useCallback(t=>c(null,null,function*(){p(null),a(null);try{yield V.checkPasswordStrength(t)}catch(n){p("Failed to check password strength")}}),[V]),checkDomain:r.useCallback(t=>c(null,null,function*(){p(null),s(null);try{yield V.checkDomain(t)}catch(n){p("Failed to check domain")}}),[V]),validatePhone:r.useCallback((t,n="TR")=>c(null,null,function*(){p(null),h(null);try{yield V.validatePhone(t,n)}catch(i){p("Failed to validate phone")}}),[V]),checkCompanyName:r.useCallback(t=>c(null,null,function*(){p(null),C(null);try{yield V.checkCompanyName(t)}catch(n){p("Failed to check company name")}}),[V]),validateIdentity:r.useCallback(t=>c(null,null,function*(){p(null),f(null);try{yield V.validateIdentity(t)}catch(n){p("Failed to validate identity number"),f({isValid:!1,message:"Doğrulama servisi geçici olarak kullanılamıyor"})}}),[V])}};export{f as u};
