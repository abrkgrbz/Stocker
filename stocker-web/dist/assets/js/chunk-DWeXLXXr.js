import{j as e,S as s,F as t,ay as a,T as l,_ as n,w as r,ax as i,aE as o,aq as c}from"./chunk-BcRR0ED4.js";import{r as d}from"./chunk-nBmrMGrr.js";import{b as h}from"../index-C7F-vNHz.js";const{Text:u}=t,p=({password:t,username:p,email:y,onStrengthChange:k,showRequirements:f=!0,showSuggestions:m=!0})=>{const[x,g]=d.useState(null),[j,v]=d.useState([]);d.useEffect(()=>{const e=setTimeout(()=>{return e=null,s=null,a=function*(){var e,s,a;if(!t)return g(null),void v([]);try{const l=yield h.post("/api/public/password/check-strength",{password:t});if(null==(e=l.data)?void 0:e.success){const e=l.data.data;g(e),null==k||k(e)}if(p||y){const e=yield h.post("/api/public/password/validate",{password:t,username:p,email:y});(null==(s=e.data)?void 0:s.success)?v([]):v((null==(a=e.data)?void 0:a.errors)||[])}}catch(l){const e=b(t);g(e),null==k||k(e)}},new Promise((t,l)=>{var n=e=>{try{i(a.next(e))}catch(s){l(s)}},r=e=>{try{i(a.throw(e))}catch(s){l(s)}},i=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,r);i((a=a.apply(e,s)).next())});var e,s,a},300);return()=>clearTimeout(e)},[t,p,y]);const b=e=>{let s=0;const t=[],a=[];e.length>=8&&s++,e.length>=12&&s++,e.length>=16&&s++,/[a-z]/.test(e)&&s++,/[A-Z]/.test(e)&&s++,/\d/.test(e)&&s++,/[!@#$%^&*()_+\-=\[\]{}|;:,.<>?]/.test(e)&&s++,s=Math.min(5,Math.floor(5*s/10)),e.length<8&&(t.push("Şifre çok kısa"),a.push("En az 8 karakter kullanın")),/[A-Z]/.test(e)||a.push("Büyük harf ekleyin"),/[a-z]/.test(e)||a.push("Küçük harf ekleyin"),/\d/.test(e)||a.push("Rakam ekleyin"),/[!@#$%^&*]/.test(e)||a.push("Özel karakter ekleyin");return{score:s,scoreLabel:["Çok Zayıf","Zayıf","Orta","Güçlü","Çok Güçlü","Mükemmel"][s]||"Bilinmiyor",entropy:4*e.length,feedback:t,suggestions:a,isAcceptable:s>=3}},z=e=>["#ff4d4f","#ff7a45","#ffa940","#52c41a","#52c41a","#389e0d"][e]||"#d9d9d9";return t?e.jsx("div",{className:"password-strength-container",children:e.jsxs(s,{direction:"vertical",style:{width:"100%"},children:[e.jsxs("div",{className:"strength-meter",children:[e.jsxs(s,{children:[e.jsx(u,{type:"secondary",children:"Şifre Gücü:"}),x&&e.jsxs(e.Fragment,{children:[(w=x.score,w<=1?e.jsx(r,{style:{color:"#ff4d4f"}}):2===w?e.jsx(o,{style:{color:"#faad14"}}):e.jsx(n,{style:{color:"#52c41a"}})),e.jsx(u,{strong:!0,style:{color:z(x.score)},children:x.scoreLabel})]})]}),e.jsx(a,{percent:20*((null==x?void 0:x.score)||0),strokeColor:z((null==x?void 0:x.score)||0),showInfo:!1,size:"small"})]}),f&&e.jsx("div",{className:"requirements-list",children:e.jsx(s,{size:[8,4],wrap:!0,children:[{key:"length",label:"En az 8 karakter",test:e=>e.length>=8},{key:"uppercase",label:"En az 1 büyük harf",test:e=>/[A-Z]/.test(e)},{key:"lowercase",label:"En az 1 küçük harf",test:e=>/[a-z]/.test(e)},{key:"digit",label:"En az 1 rakam",test:e=>/\d/.test(e)},{key:"special",label:"En az 1 özel karakter (!@#$%^&*)",test:e=>/[!@#$%^&*()_+\-=\[\]{}|;:,.<>?]/.test(e)}].map(s=>{const a=s.test(t);return e.jsx(l,{icon:a?e.jsx(n,{}):e.jsx(r,{}),color:a?"success":"default",children:s.label},s.key)})})}),j.length>0&&e.jsx("div",{className:"validation-errors",children:j.map((s,t)=>e.jsxs(u,{type:"danger",style:{display:"block"},children:[e.jsx(r,{})," ",s.message]},t))}),m&&(null==x?void 0:x.suggestions)&&x.suggestions.length>0&&e.jsxs("div",{className:"suggestions",children:[e.jsxs(u,{type:"secondary",style:{fontSize:12},children:[e.jsx(i,{})," Öneriler:"]}),e.jsx("ul",{style:{margin:"4px 0 0 20px",padding:0},children:x.suggestions.map((s,t)=>e.jsx("li",{children:e.jsx(u,{type:"secondary",style:{fontSize:12},children:s})},t))})]}),(null==x?void 0:x.feedback)&&x.feedback.length>0&&e.jsx("div",{className:"feedback",children:x.feedback.map((s,t)=>e.jsxs(u,{type:"warning",style:{display:"block",fontSize:12},children:[e.jsx(o,{})," ",s]},t))}),x&&x.entropy>0&&e.jsx(c,{title:"Entropi, şifrenizin tahmin edilme zorluğunu gösterir. Yüksek entropi = daha güvenli",children:e.jsxs(u,{type:"secondary",style:{fontSize:11},children:["Entropi: ",Math.round(x.entropy)," bit"]})})]})}):null;var w};export{p as P};
