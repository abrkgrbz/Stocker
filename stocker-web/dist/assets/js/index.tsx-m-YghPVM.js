var e=(e,s,a)=>new Promise((l,r)=>{var i=e=>{try{t(a.next(e))}catch(s){r(s)}},n=e=>{try{t(a.throw(e))}catch(s){r(s)}},t=e=>e.done?l(e.value):Promise.resolve(e.value).then(i,n);t((a=a.apply(e,s)).next())});import{ah as s,am as a,j as l,t as r,S as i,F as n,R as t,Q as c,k as d,aH as o,_ as m,aF as h,O as x,ao as u,Z as j,as as g,M as y,N as p,aI as v,aJ as k,Y as b,ai as f,aK as N,v as S,u as T,aL as z,ar as w,ay as D,aD as I,aq as P,J as B,s as C,aB as A,ak as K,aM as F}from"./chunk-BP2PJDjm.js";import{u as M,m as Y,r as $}from"./chunk-nBmrMGrr.js";import{a as G}from"../index-CUfPaT5I.js";import"./chunk-BsETiAjl.js";const{Title:L,Text:E,Paragraph:V}=n,{Step:_}=c,{TabPane:q}=h,R=()=>{const n=M(),[_]=Y(),[R]=s.useForm(),[O,H]=$.useState("credit_card"),[W,J]=$.useState(0),[Q,U]=$.useState(!1),[X,Z]=$.useState(!1),[ee,se]=$.useState(""),[ae,le]=$.useState(180),[re,ie]=$.useState(!1),[ne,te]=$.useState(""),[ce,de]=$.useState(""),[oe,me]=$.useState(null),[he,xe]=$.useState(""),[ue,je]=$.useState(""),[ge,ye]=$.useState(""),[pe,ve]=$.useState(""),[ke,be]=$.useState(""),[fe,Ne]=$.useState(1);$.useEffect(()=>{const e={tenantId:_.get("tenantId")||"",packageId:_.get("packageId")||"",packageName:_.get("package")||"Profesyonel",amount:Number(_.get("amount"))||999,currency:"₺",billingPeriod:_.get("period")||"Monthly",companyName:_.get("company")||"Demo Şirket",contactEmail:_.get("email")||"demo@example.com"};me(e)},[_]),$.useEffect(()=>{if(X&&ae>0){const e=setTimeout(()=>le(ae-1),1e3);return()=>clearTimeout(e)}0===ae&&(a.error("3D Secure doğrulama süresi doldu"),Z(!1),le(180))},[X,ae]);const Se=e=>{const s=(e=>{const s=e.replace(/\s+/g,"").replace(/[^0-9]/gi,"").match(/\d{4,16}/g),a=s&&s[0]||"",l=[];for(let r=0,i=a.length;r<i;r+=4)l.push(a.substring(r,r+4));return l.length?l.join(" "):e})(e.target.value);xe(s),be((e=>{const s=e.replace(/\s/g,"");return s.startsWith("4")?"visa":s.startsWith("5")?"mastercard":s.startsWith("3")?"amex":s.startsWith("6")?"troy":""})(s))},Te=()=>{if(!oe)return[];const e=oe.amount;return[{value:1,label:"Tek Çekim",amount:e},{value:2,label:"2 Taksit",amount:e/2},{value:3,label:"3 Taksit",amount:e/3},{value:6,label:"6 Taksit",amount:e/6},{value:9,label:"9 Taksit",amount:e/9},{value:12,label:"12 Taksit",amount:e/12}]},ze=s=>e(null,null,function*(){U(!0),J(1),yield new Promise(e=>setTimeout(e,2e3)),Z(!0),U(!1)}),we=()=>e(null,null,function*(){if("123456"!==ee)return void a.error("Doğrulama kodu hatalı");U(!0),Z(!1),J(2),yield new Promise(e=>setTimeout(e,3e3));const e=`TRX${Date.now()}`,s=`INV-${Date.now()}`;te(e),de(s);try{yield G.post("/api/public/process-payment",{tenantId:null==oe?void 0:oe.tenantId,packageId:null==oe?void 0:oe.packageId,amount:null==oe?void 0:oe.amount,currency:null==oe?void 0:oe.currency,paymentMethod:"credit_card",billingPeriod:null==oe?void 0:oe.billingPeriod,transactionId:e,invoiceNumber:s}),ie(!0),a.success("Ödeme başarıyla tamamlandı!")}catch(l){a.error("Ödeme işlemi başarısız")}finally{U(!1)}});return oe?l.jsxs("div",{className:"payment-page",children:[l.jsx("div",{className:"payment-header",children:l.jsxs("div",{className:"container",children:[l.jsxs(i,{size:"large",children:[l.jsx("img",{src:"/logo.png",alt:"Stocker",style:{height:40}}),l.jsx(L,{level:3,style:{margin:0,color:"#fff"},children:"Güvenli Ödeme"})]}),l.jsxs(i,{children:[l.jsx(t,{style:{fontSize:24,color:"#52c41a"}}),l.jsx(E,{style:{color:"#fff"},children:"256-bit SSL Güvenlik"})]})]})}),l.jsx("div",{className:"payment-content",children:l.jsxs("div",{className:"container",children:[l.jsx(c,{current:W,style:{marginBottom:32},items:[{title:"Ödeme Bilgileri",icon:l.jsx(d,{})},{title:"Doğrulama",icon:l.jsx(o,{})},{title:"Tamamlandı",icon:l.jsx(m,{})}]}),re?l.jsx(T,{status:"success",title:"Ödeme Başarılı!",subTitle:l.jsxs("div",{children:[l.jsx(V,{children:"Ödemeniz başarıyla alındı ve hesabınız aktif edildi."}),l.jsxs(i,{direction:"vertical",style:{width:"100%",marginTop:24},children:[l.jsxs("div",{className:"success-detail",children:[l.jsx(E,{type:"secondary",children:"İşlem No:"}),l.jsx(E,{strong:!0,copyable:!0,children:ne})]}),l.jsxs("div",{className:"success-detail",children:[l.jsx(E,{type:"secondary",children:"Fatura No:"}),l.jsx(E,{strong:!0,copyable:!0,children:ce})]}),l.jsxs("div",{className:"success-detail",children:[l.jsx(E,{type:"secondary",children:"Tutar:"}),l.jsxs(E,{strong:!0,children:[null==oe?void 0:oe.currency,null==oe?void 0:oe.amount]})]}),l.jsxs("div",{className:"success-detail",children:[l.jsx(E,{type:"secondary",children:"Tarih:"}),l.jsx(E,{strong:!0,children:(new Date).toLocaleString("tr-TR")})]})]})]}),extra:[l.jsx(S,{icon:l.jsx(z,{}),children:"Faturayı İndir"},"invoice"),l.jsx(S,{type:"primary",icon:l.jsx(m,{}),onClick:()=>n("/login"),children:"Panele Git"},"console")]}):l.jsx(l.Fragment,{children:l.jsxs(h,{activeKey:O,onChange:e=>H(e),size:"large",children:[l.jsx(q,{tab:l.jsxs(i,{children:[l.jsx(d,{}),"Kredi/Banka Kartı"]}),children:l.jsx("div",{className:"payment-form-container",children:l.jsxs(y,{gutter:[32,32],children:[l.jsxs(p,{xs:24,lg:14,children:[l.jsxs(x,{className:"payment-form-card",children:[l.jsxs(L,{level:4,children:[l.jsx(d,{})," Kart Bilgileri"]}),l.jsxs(s,{form:R,layout:"vertical",onFinish:ze,autoComplete:"off",children:[l.jsx(s.Item,{label:"Kart Numarası",name:"cardNumber",rules:[{required:!0,message:"Kart numarası zorunludur"},{pattern:/^[\d\s]{19}$/,message:"Geçerli bir kart numarası giriniz"}],children:l.jsx(f,{size:"large",placeholder:"1234 5678 9012 3456",value:he,onChange:Se,maxLength:19,prefix:l.jsx(d,{}),suffix:ke&&l.jsx("img",{src:`/images/cards/${ke}.png`,alt:ke,style:{height:20}})})}),l.jsx(s.Item,{label:"Kart Üzerindeki İsim",name:"cardName",rules:[{required:!0,message:"Kart sahibi adı zorunludur"}],children:l.jsx(f,{size:"large",placeholder:"AD SOYAD",value:ue,onChange:e=>je(e.target.value.toUpperCase()),style:{textTransform:"uppercase"}})}),l.jsxs(y,{gutter:16,children:[l.jsx(p,{span:12,children:l.jsx(s.Item,{label:"Son Kullanma Tarihi",name:"expiry",rules:[{required:!0,message:"Son kullanma tarihi zorunludur"},{pattern:/^(0[1-9]|1[0-2])\/\d{2}$/,message:"AA/YY formatında giriniz"}],children:l.jsx(f,{size:"large",placeholder:"AA/YY",value:ge,onChange:e=>ye((e=>{const s=e.replace(/\s+/g,"").replace(/[^0-9]/gi,"");return s.length>=2?s.substring(0,2)+"/"+s.substring(2,4):s})(e.target.value)),maxLength:5})})}),l.jsx(p,{span:12,children:l.jsx(s.Item,{label:l.jsxs(i,{children:["CVV",l.jsx(w,{title:"Kartınızın arkasındaki 3 haneli güvenlik kodu",children:l.jsx(D,{})})]}),name:"cvv",rules:[{required:!0,message:"CVV zorunludur"},{pattern:/^\d{3,4}$/,message:"3 veya 4 haneli CVV giriniz"}],children:l.jsx(f.Password,{size:"large",placeholder:"123",value:pe,onChange:e=>ve(e.target.value),maxLength:4})})})]}),l.jsx(s.Item,{label:"Taksit Seçenekleri",children:l.jsx(I.Group,{value:fe,onChange:e=>Ne(e.target.value),style:{width:"100%"},children:l.jsx(y,{gutter:[8,8],children:Te().map(e=>l.jsx(p,{span:8,children:l.jsx(I.Button,{value:e.value,style:{width:"100%",textAlign:"center"},children:l.jsxs("div",{children:[l.jsx(E,{strong:!0,children:e.label}),l.jsx("br",{}),l.jsxs(E,{type:"secondary",style:{fontSize:12},children:[null==oe?void 0:oe.currency,e.amount.toFixed(2)]})]})})},e.value))})})}),l.jsx(b,{}),l.jsx(s.Item,{name:"saveCard",valuePropName:"checked",children:l.jsx(P,{children:"Kartımı gelecek ödemeler için kaydet"})}),l.jsx(s.Item,{name:"agreement",valuePropName:"checked",rules:[{validator:(e,s)=>s?Promise.resolve():Promise.reject(new Error("Sözleşmeyi kabul etmelisiniz"))}],children:l.jsxs(P,{children:[l.jsx("a",{href:"#",target:"_blank",children:"Ön Bilgilendirme Formu"})," ve"," ",l.jsx("a",{href:"#",target:"_blank",children:"Mesafeli Satış Sözleşmesi"}),"'ni okudum ve kabul ediyorum"]})}),l.jsx(S,{type:"primary",htmlType:"submit",size:"large",block:!0,loading:Q,icon:l.jsx(B,{}),children:"Güvenli Ödeme Yap"})]}),l.jsx(b,{}),l.jsx("div",{className:"security-badges",children:l.jsxs(i,{size:"large",wrap:!0,children:[l.jsxs(i,{children:[l.jsx(t,{style:{fontSize:24,color:"#52c41a"}}),l.jsx(E,{children:"256-bit SSL"})]}),l.jsxs(i,{children:[l.jsx(o,{style:{fontSize:24,color:"#1890ff"}}),l.jsx(E,{children:"PCI DSS"})]}),l.jsxs(i,{children:[l.jsx(z,{style:{fontSize:24,color:"#722ed1"}}),l.jsx(E,{children:"3D Secure"})]})]})})]}),l.jsxs(x,{className:"bank-logos",style:{marginTop:16},children:[l.jsx(E,{type:"secondary",children:"Anlaşmalı Bankalar:"}),l.jsx("div",{className:"bank-logo-grid",children:["garanti","isbank","akbank","yapikredi","qnb","denizbank","teb","ing"].map(e=>l.jsx("div",{className:"bank-logo",children:l.jsx("img",{src:`/images/banks/${e}.png`,alt:e})},e))})]})]}),l.jsxs(p,{xs:24,lg:10,children:[l.jsx("div",{className:"credit-card-visual",children:l.jsx("div",{className:`credit-card ${ke}`,children:l.jsxs("div",{className:"card-front",children:[l.jsx("div",{className:"card-chip"}),l.jsx("div",{className:"card-logo",children:ke&&l.jsx("img",{src:`/images/cards/${ke}-white.png`,alt:ke})}),l.jsx("div",{className:"card-number",children:he||"•••• •••• •••• ••••"}),l.jsxs("div",{className:"card-info",children:[l.jsxs("div",{className:"card-holder",children:[l.jsx(E,{className:"label",children:"Card Holder"}),l.jsx(E,{className:"value",children:ue||"AD SOYAD"})]}),l.jsxs("div",{className:"card-expiry",children:[l.jsx(E,{className:"label",children:"Expires"}),l.jsx(E,{className:"value",children:ge||"AA/YY"})]})]})]})})}),l.jsxs(x,{className:"order-summary",style:{marginTop:24},children:[l.jsxs(L,{level:4,children:[l.jsx(C,{})," Sipariş Özeti"]}),l.jsxs("div",{className:"summary-item",children:[l.jsx(E,{children:"Şirket:"}),l.jsx(E,{strong:!0,children:null==oe?void 0:oe.companyName})]}),l.jsxs("div",{className:"summary-item",children:[l.jsx(E,{children:"Paket:"}),l.jsx(E,{strong:!0,children:null==oe?void 0:oe.packageName})]}),l.jsxs("div",{className:"summary-item",children:[l.jsx(E,{children:"Dönem:"}),l.jsx(E,{strong:!0,children:"Monthly"===(null==oe?void 0:oe.billingPeriod)?"Aylık":"Yıllık"})]}),fe>1&&l.jsxs("div",{className:"summary-item",children:[l.jsx(E,{children:"Taksit:"}),l.jsxs(E,{strong:!0,children:[fe," Taksit"]})]}),l.jsx(b,{}),l.jsxs("div",{className:"summary-total",children:[l.jsx(L,{level:5,children:"Toplam Tutar"}),l.jsxs(L,{level:3,style:{margin:0,color:"#52c41a"},children:[null==oe?void 0:oe.currency,null==oe?void 0:oe.amount]}),fe>1&&l.jsxs(E,{type:"secondary",children:[fe," x ",null==oe?void 0:oe.currency,((null==oe?void 0:oe.amount)||0)/fe]})]}),l.jsx(u,{message:"Güvenli Ödeme",description:"Tüm işlemleriniz 256-bit SSL ile korunmaktadır",type:"success",showIcon:!0,icon:l.jsx(t,{}),style:{marginTop:16}})]}),l.jsxs(x,{style:{marginTop:16},children:[l.jsx(L,{level:5,children:"Yardım ve Destek"}),l.jsxs(i,{direction:"vertical",style:{width:"100%"},children:[l.jsxs(E,{children:[l.jsx(A,{})," 0850 123 45 67"]}),l.jsxs(E,{children:[l.jsx(K,{})," destek@stocker.com"]}),l.jsxs(E,{children:[l.jsx(F,{})," 7/24 Canlı Destek"]})]})]})]})]})})},"credit_card"),l.jsx(q,{tab:l.jsxs(i,{children:[l.jsx(g,{}),"Havale/EFT"]}),children:l.jsxs(x,{children:[l.jsx(u,{message:"Banka Havalesi Bilgileri",description:"Aşağıdaki hesap bilgilerine havale/EFT yapabilirsiniz.",type:"info",showIcon:!0,style:{marginBottom:24}}),l.jsx(j,{dataSource:[{bank:"Garanti BBVA",iban:"TR12 0006 2000 1234 0006 2345 67",branch:"Levent Şubesi"},{bank:"İş Bankası",iban:"TR34 0006 4000 0011 2345 6789 00",branch:"Maslak Şubesi"},{bank:"Akbank",iban:"TR56 0004 6000 5888 8000 1234 56",branch:"Sarıyer Şubesi"}],renderItem:e=>l.jsx(j.Item,{children:l.jsx(x,{style:{width:"100%"},children:l.jsxs(i,{direction:"vertical",style:{width:"100%"},children:[l.jsx(E,{strong:!0,children:e.bank}),l.jsx(E,{copyable:!0,children:e.iban}),l.jsx(E,{type:"secondary",children:e.branch})]})})})}),l.jsx(u,{message:"Önemli",description:`Açıklama kısmına "${oe.companyName} - ${ce}" yazınız.`,type:"warning",style:{marginTop:16}})]})},"bank_transfer"),l.jsx(q,{tab:l.jsxs(i,{children:[l.jsx(v,{}),"Dijital Cüzdan"]}),children:l.jsx(x,{children:l.jsx(y,{gutter:[16,16],children:["PayPal","Apple Pay","Google Pay","BKM Express"].map(e=>l.jsx(p,{span:12,children:l.jsx(x,{hoverable:!0,className:"wallet-card",onClick:()=>a.info(`${e} ile ödeme simülasyonu`),children:l.jsxs(i,{direction:"vertical",align:"center",style:{width:"100%"},children:[l.jsx(v,{style:{fontSize:48,color:"#1890ff"}}),l.jsx(E,{strong:!0,children:e})]})})},e))})})},"digital_wallet")]})})]})}),l.jsx(k,{title:l.jsxs(i,{children:[l.jsx(o,{style:{color:"#1890ff"}}),"3D Secure Doğrulama"]}),visible:X,footer:null,closable:!1,width:500,children:l.jsxs("div",{className:"secure-3d-container",children:[l.jsx(u,{message:"Güvenlik Doğrulaması",description:"Bankanız tarafından cep telefonunuza SMS ile gönderilen 6 haneli doğrulama kodunu giriniz.",type:"info",showIcon:!0,style:{marginBottom:24}}),l.jsxs("div",{className:"bank-info",children:[l.jsx("img",{src:"/images/banks/bank-logo.png",alt:"Bank",style:{height:40}}),l.jsx(L,{level:5,style:{margin:"16px 0"},children:"DEMO BANK 3D Secure"})]}),l.jsxs("div",{className:"transaction-info",children:[l.jsxs("div",{className:"info-row",children:[l.jsx(E,{type:"secondary",children:"İşyeri:"}),l.jsx(E,{strong:!0,children:"Stocker SaaS Platform"})]}),l.jsxs("div",{className:"info-row",children:[l.jsx(E,{type:"secondary",children:"Tutar:"}),l.jsxs(E,{strong:!0,children:[null==oe?void 0:oe.currency,null==oe?void 0:oe.amount]})]}),l.jsxs("div",{className:"info-row",children:[l.jsx(E,{type:"secondary",children:"Tarih:"}),l.jsx(E,{strong:!0,children:(new Date).toLocaleString("tr-TR")})]}),l.jsxs("div",{className:"info-row",children:[l.jsx(E,{type:"secondary",children:"Kart:"}),l.jsxs(E,{strong:!0,children:["**** **** **** ",he.slice(-4)]})]})]}),l.jsx(b,{}),l.jsxs(s,{onFinish:we,children:[l.jsx(s.Item,{label:"SMS Doğrulama Kodu",name:"smsCode",rules:[{required:!0,message:"Doğrulama kodu zorunludur"}],extra:l.jsxs(i,{children:[l.jsx(E,{type:"secondary",children:"Demo için kod:"}),l.jsx(E,{type:"success",strong:!0,children:"123456"})]}),children:l.jsx(f,{size:"large",placeholder:"6 haneli kod",maxLength:6,value:ee,onChange:e=>se(e.target.value),prefix:l.jsx(N,{}),suffix:l.jsxs(E,{type:"secondary",children:[Math.floor(ae/60),":",(ae%60).toString().padStart(2,"0")]})})}),l.jsxs(y,{gutter:16,children:[l.jsx(p,{span:12,children:l.jsx(S,{size:"large",block:!0,onClick:()=>{Z(!1),a.info("İşlem iptal edildi")},children:"İptal"})}),l.jsx(p,{span:12,children:l.jsx(S,{type:"primary",size:"large",block:!0,htmlType:"submit",loading:Q,children:"Doğrula ve Öde"})})]})]}),l.jsx(u,{message:"Test Ortamı",description:"Bu bir test işlemidir. Gerçek ödeme alınmayacaktır.",type:"warning",style:{marginTop:16}})]})})]}):l.jsx("div",{style:{textAlign:"center",padding:100},children:l.jsx(r,{size:"large"})})};export{R as PaymentPage};
