var M=(R,d,j)=>new Promise(($,T)=>{var A=t=>{try{g(j.next(t))}catch(u){T(u)}},C=t=>{try{g(j.throw(t))}catch(u){T(u)}},g=t=>t.done?$(t.value):Promise.resolve(t.value).then(A,C);g((j=j.apply(R,d)).next())});import{ag as c,am as y,j as e,t as Te,S as l,F as Ce,R as E,Q as Z,k as w,aM as F,_ as H,aK as D,O as o,an as b,Z as W,aC as ze,M as k,N as m,aN as Q,aO as Ie,Y as P,ah as S,aP as we,v as N,u as Pe,aQ as J,aF as Re,az as $e,aH as U,aG as X,J as Ae,s as Be,aB as Ke,aj as Me,aR as Ee}from"./chunk-CQugYT0Y.js";import{u as Fe,m as Le,r as n}from"./chunk-a6Wk6XzP.js";import{b as Ge}from"../index-BEW7Pg8Q.js";import"./chunk-CX9aqCgN.js";const{Title:x,Text:a,Paragraph:Ye}=Ce,{Step:We}=Z,{TabPane:L}=D,Qe=()=>{const R=Fe(),[d]=Le(),[j]=c.useForm(),[$,T]=n.useState("credit_card"),[A,C]=n.useState(0),[g,t]=n.useState(!1),[u,z]=n.useState(!1),[G,ee]=n.useState(""),[p,Y]=n.useState(180),[se,re]=n.useState(!1),[ae,ie]=n.useState(""),[_,ne]=n.useState(""),[s,le]=n.useState(null),[B,te]=n.useState(""),[O,ce]=n.useState(""),[V,de]=n.useState(""),[oe,me]=n.useState(""),[h,ue]=n.useState(""),[v,he]=n.useState(1);n.useEffect(()=>{const r={tenantId:d.get("tenantId")||"",packageId:d.get("packageId")||"",packageName:d.get("package")||"Profesyonel",amount:Number(d.get("amount"))||999,currency:"₺",billingPeriod:d.get("period")||"Monthly",companyName:d.get("company")||"Demo Şirket",contactEmail:d.get("email")||"demo@example.com"};le(r)},[d]),n.useEffect(()=>{if(u&&p>0){const r=setTimeout(()=>Y(p-1),1e3);return()=>clearTimeout(r)}else p===0&&(y.error("3D Secure doğrulama süresi doldu"),z(!1),Y(180))},[u,p]);const xe=r=>{const i=r.replace(/\s/g,"");return i.startsWith("4")?"visa":i.startsWith("5")?"mastercard":i.startsWith("3")?"amex":i.startsWith("6")?"troy":""},je=r=>{const f=r.replace(/\s+/g,"").replace(/[^0-9]/gi,"").match(/\d{4,16}/g),q=f&&f[0]||"",K=[];for(let I=0,Ne=q.length;I<Ne;I+=4)K.push(q.substring(I,I+4));return K.length?K.join(" "):r},ge=r=>{const i=r.replace(/\s+/g,"").replace(/[^0-9]/gi,"");return i.length>=2?i.substring(0,2)+"/"+i.substring(2,4):i},pe=r=>{const i=je(r.target.value);te(i),ue(xe(i))},ve=()=>{if(!s)return[];const r=s.amount;return[{value:1,label:"Tek Çekim",amount:r},{value:2,label:"2 Taksit",amount:r/2},{value:3,label:"3 Taksit",amount:r/3},{value:6,label:"6 Taksit",amount:r/6},{value:9,label:"9 Taksit",amount:r/9},{value:12,label:"12 Taksit",amount:r/12}]},ye=r=>M(null,null,function*(){t(!0),C(1),yield new Promise(i=>setTimeout(i,2e3)),z(!0),t(!1)}),fe=()=>M(null,null,function*(){if(G!=="123456"){y.error("Doğrulama kodu hatalı");return}t(!0),z(!1),C(2),yield new Promise(f=>setTimeout(f,3e3));const r=`TRX${Date.now()}`,i=`INV-${Date.now()}`;ie(r),ne(i);try{yield Ge.post("/api/public/process-payment",{tenantId:s==null?void 0:s.tenantId,packageId:s==null?void 0:s.packageId,amount:s==null?void 0:s.amount,currency:s==null?void 0:s.currency,paymentMethod:"credit_card",billingPeriod:s==null?void 0:s.billingPeriod,transactionId:r,invoiceNumber:i}),re(!0),y.success("Ödeme başarıyla tamamlandı!")}catch(f){y.error("Ödeme işlemi başarısız")}finally{t(!1)}}),be=()=>e.jsx("div",{className:"payment-form-container",children:e.jsxs(k,{gutter:[32,32],children:[e.jsxs(m,{xs:24,lg:14,children:[e.jsxs(o,{className:"payment-form-card",children:[e.jsxs(x,{level:4,children:[e.jsx(w,{})," Kart Bilgileri"]}),e.jsxs(c,{form:j,layout:"vertical",onFinish:ye,autoComplete:"off",children:[e.jsx(c.Item,{label:"Kart Numarası",name:"cardNumber",rules:[{required:!0,message:"Kart numarası zorunludur"},{pattern:/^[\d\s]{19}$/,message:"Geçerli bir kart numarası giriniz"}],children:e.jsx(S,{size:"large",placeholder:"1234 5678 9012 3456",value:B,onChange:pe,maxLength:19,prefix:e.jsx(w,{}),suffix:h&&e.jsx("img",{src:`/images/cards/${h}.png`,alt:h,style:{height:20}})})}),e.jsx(c.Item,{label:"Kart Üzerindeki İsim",name:"cardName",rules:[{required:!0,message:"Kart sahibi adı zorunludur"}],children:e.jsx(S,{size:"large",placeholder:"AD SOYAD",value:O,onChange:r=>ce(r.target.value.toUpperCase()),style:{textTransform:"uppercase"}})}),e.jsxs(k,{gutter:16,children:[e.jsx(m,{span:12,children:e.jsx(c.Item,{label:"Son Kullanma Tarihi",name:"expiry",rules:[{required:!0,message:"Son kullanma tarihi zorunludur"},{pattern:/^(0[1-9]|1[0-2])\/\d{2}$/,message:"AA/YY formatında giriniz"}],children:e.jsx(S,{size:"large",placeholder:"AA/YY",value:V,onChange:r=>de(ge(r.target.value)),maxLength:5})})}),e.jsx(m,{span:12,children:e.jsx(c.Item,{label:e.jsxs(l,{children:["CVV",e.jsx(Re,{title:"Kartınızın arkasındaki 3 haneli güvenlik kodu",children:e.jsx($e,{})})]}),name:"cvv",rules:[{required:!0,message:"CVV zorunludur"},{pattern:/^\d{3,4}$/,message:"3 veya 4 haneli CVV giriniz"}],children:e.jsx(S.Password,{size:"large",placeholder:"123",value:oe,onChange:r=>me(r.target.value),maxLength:4})})})]}),e.jsx(c.Item,{label:"Taksit Seçenekleri",children:e.jsx(U.Group,{value:v,onChange:r=>he(r.target.value),style:{width:"100%"},children:e.jsx(k,{gutter:[8,8],children:ve().map(r=>e.jsx(m,{span:8,children:e.jsx(U.Button,{value:r.value,style:{width:"100%",textAlign:"center"},children:e.jsxs("div",{children:[e.jsx(a,{strong:!0,children:r.label}),e.jsx("br",{}),e.jsxs(a,{type:"secondary",style:{fontSize:12},children:[s==null?void 0:s.currency,r.amount.toFixed(2)]})]})})},r.value))})})}),e.jsx(P,{}),e.jsx(c.Item,{name:"saveCard",valuePropName:"checked",children:e.jsx(X,{children:"Kartımı gelecek ödemeler için kaydet"})}),e.jsx(c.Item,{name:"agreement",valuePropName:"checked",rules:[{validator:(r,i)=>i?Promise.resolve():Promise.reject(new Error("Sözleşmeyi kabul etmelisiniz"))}],children:e.jsxs(X,{children:[e.jsx("a",{href:"#",target:"_blank",children:"Ön Bilgilendirme Formu"})," ve"," ",e.jsx("a",{href:"#",target:"_blank",children:"Mesafeli Satış Sözleşmesi"}),"'ni okudum ve kabul ediyorum"]})}),e.jsx(N,{type:"primary",htmlType:"submit",size:"large",block:!0,loading:g,icon:e.jsx(Ae,{}),children:"Güvenli Ödeme Yap"})]}),e.jsx(P,{}),e.jsx("div",{className:"security-badges",children:e.jsxs(l,{size:"large",wrap:!0,children:[e.jsxs(l,{children:[e.jsx(E,{style:{fontSize:24,color:"#52c41a"}}),e.jsx(a,{children:"256-bit SSL"})]}),e.jsxs(l,{children:[e.jsx(F,{style:{fontSize:24,color:"#1890ff"}}),e.jsx(a,{children:"PCI DSS"})]}),e.jsxs(l,{children:[e.jsx(J,{style:{fontSize:24,color:"#722ed1"}}),e.jsx(a,{children:"3D Secure"})]})]})})]}),e.jsxs(o,{className:"bank-logos",style:{marginTop:16},children:[e.jsx(a,{type:"secondary",children:"Anlaşmalı Bankalar:"}),e.jsx("div",{className:"bank-logo-grid",children:["garanti","isbank","akbank","yapikredi","qnb","denizbank","teb","ing"].map(r=>e.jsx("div",{className:"bank-logo",children:e.jsx("img",{src:`/images/banks/${r}.png`,alt:r})},r))})]})]}),e.jsxs(m,{xs:24,lg:10,children:[e.jsx("div",{className:"credit-card-visual",children:e.jsx("div",{className:`credit-card ${h}`,children:e.jsxs("div",{className:"card-front",children:[e.jsx("div",{className:"card-chip"}),e.jsx("div",{className:"card-logo",children:h&&e.jsx("img",{src:`/images/cards/${h}-white.png`,alt:h})}),e.jsx("div",{className:"card-number",children:B||"•••• •••• •••• ••••"}),e.jsxs("div",{className:"card-info",children:[e.jsxs("div",{className:"card-holder",children:[e.jsx(a,{className:"label",children:"Card Holder"}),e.jsx(a,{className:"value",children:O||"AD SOYAD"})]}),e.jsxs("div",{className:"card-expiry",children:[e.jsx(a,{className:"label",children:"Expires"}),e.jsx(a,{className:"value",children:V||"AA/YY"})]})]})]})})}),e.jsxs(o,{className:"order-summary",style:{marginTop:24},children:[e.jsxs(x,{level:4,children:[e.jsx(Be,{})," Sipariş Özeti"]}),e.jsxs("div",{className:"summary-item",children:[e.jsx(a,{children:"Şirket:"}),e.jsx(a,{strong:!0,children:s==null?void 0:s.companyName})]}),e.jsxs("div",{className:"summary-item",children:[e.jsx(a,{children:"Paket:"}),e.jsx(a,{strong:!0,children:s==null?void 0:s.packageName})]}),e.jsxs("div",{className:"summary-item",children:[e.jsx(a,{children:"Dönem:"}),e.jsx(a,{strong:!0,children:(s==null?void 0:s.billingPeriod)==="Monthly"?"Aylık":"Yıllık"})]}),v>1&&e.jsxs("div",{className:"summary-item",children:[e.jsx(a,{children:"Taksit:"}),e.jsxs(a,{strong:!0,children:[v," Taksit"]})]}),e.jsx(P,{}),e.jsxs("div",{className:"summary-total",children:[e.jsx(x,{level:5,children:"Toplam Tutar"}),e.jsxs(x,{level:3,style:{margin:0,color:"#52c41a"},children:[s==null?void 0:s.currency,s==null?void 0:s.amount]}),v>1&&e.jsxs(a,{type:"secondary",children:[v," x ",s==null?void 0:s.currency,((s==null?void 0:s.amount)||0)/v]})]}),e.jsx(b,{message:"Güvenli Ödeme",description:"Tüm işlemleriniz 256-bit SSL ile korunmaktadır",type:"success",showIcon:!0,icon:e.jsx(E,{}),style:{marginTop:16}})]}),e.jsxs(o,{style:{marginTop:16},children:[e.jsx(x,{level:5,children:"Yardım ve Destek"}),e.jsxs(l,{direction:"vertical",style:{width:"100%"},children:[e.jsxs(a,{children:[e.jsx(Ke,{})," 0850 123 45 67"]}),e.jsxs(a,{children:[e.jsx(Me,{})," destek@stocker.com"]}),e.jsxs(a,{children:[e.jsx(Ee,{})," 7/24 Canlı Destek"]})]})]})]})]})}),ke=()=>e.jsx(Ie,{title:e.jsxs(l,{children:[e.jsx(F,{style:{color:"#1890ff"}}),"3D Secure Doğrulama"]}),visible:u,footer:null,closable:!1,width:500,children:e.jsxs("div",{className:"secure-3d-container",children:[e.jsx(b,{message:"Güvenlik Doğrulaması",description:"Bankanız tarafından cep telefonunuza SMS ile gönderilen 6 haneli doğrulama kodunu giriniz.",type:"info",showIcon:!0,style:{marginBottom:24}}),e.jsxs("div",{className:"bank-info",children:[e.jsx("img",{src:"/images/banks/bank-logo.png",alt:"Bank",style:{height:40}}),e.jsx(x,{level:5,style:{margin:"16px 0"},children:"DEMO BANK 3D Secure"})]}),e.jsxs("div",{className:"transaction-info",children:[e.jsxs("div",{className:"info-row",children:[e.jsx(a,{type:"secondary",children:"İşyeri:"}),e.jsx(a,{strong:!0,children:"Stocker SaaS Platform"})]}),e.jsxs("div",{className:"info-row",children:[e.jsx(a,{type:"secondary",children:"Tutar:"}),e.jsxs(a,{strong:!0,children:[s==null?void 0:s.currency,s==null?void 0:s.amount]})]}),e.jsxs("div",{className:"info-row",children:[e.jsx(a,{type:"secondary",children:"Tarih:"}),e.jsx(a,{strong:!0,children:new Date().toLocaleString("tr-TR")})]}),e.jsxs("div",{className:"info-row",children:[e.jsx(a,{type:"secondary",children:"Kart:"}),e.jsxs(a,{strong:!0,children:["**** **** **** ",B.slice(-4)]})]})]}),e.jsx(P,{}),e.jsxs(c,{onFinish:fe,children:[e.jsx(c.Item,{label:"SMS Doğrulama Kodu",name:"smsCode",rules:[{required:!0,message:"Doğrulama kodu zorunludur"}],extra:e.jsxs(l,{children:[e.jsx(a,{type:"secondary",children:"Demo için kod:"}),e.jsx(a,{type:"success",strong:!0,children:"123456"})]}),children:e.jsx(S,{size:"large",placeholder:"6 haneli kod",maxLength:6,value:G,onChange:r=>ee(r.target.value),prefix:e.jsx(we,{}),suffix:e.jsxs(a,{type:"secondary",children:[Math.floor(p/60),":",(p%60).toString().padStart(2,"0")]})})}),e.jsxs(k,{gutter:16,children:[e.jsx(m,{span:12,children:e.jsx(N,{size:"large",block:!0,onClick:()=>{z(!1),y.info("İşlem iptal edildi")},children:"İptal"})}),e.jsx(m,{span:12,children:e.jsx(N,{type:"primary",size:"large",block:!0,htmlType:"submit",loading:g,children:"Doğrula ve Öde"})})]})]}),e.jsx(b,{message:"Test Ortamı",description:"Bu bir test işlemidir. Gerçek ödeme alınmayacaktır.",type:"warning",style:{marginTop:16}})]})}),Se=()=>e.jsx(Pe,{status:"success",title:"Ödeme Başarılı!",subTitle:e.jsxs("div",{children:[e.jsx(Ye,{children:"Ödemeniz başarıyla alındı ve hesabınız aktif edildi."}),e.jsxs(l,{direction:"vertical",style:{width:"100%",marginTop:24},children:[e.jsxs("div",{className:"success-detail",children:[e.jsx(a,{type:"secondary",children:"İşlem No:"}),e.jsx(a,{strong:!0,copyable:!0,children:ae})]}),e.jsxs("div",{className:"success-detail",children:[e.jsx(a,{type:"secondary",children:"Fatura No:"}),e.jsx(a,{strong:!0,copyable:!0,children:_})]}),e.jsxs("div",{className:"success-detail",children:[e.jsx(a,{type:"secondary",children:"Tutar:"}),e.jsxs(a,{strong:!0,children:[s==null?void 0:s.currency,s==null?void 0:s.amount]})]}),e.jsxs("div",{className:"success-detail",children:[e.jsx(a,{type:"secondary",children:"Tarih:"}),e.jsx(a,{strong:!0,children:new Date().toLocaleString("tr-TR")})]})]})]}),extra:[e.jsx(N,{icon:e.jsx(J,{}),children:"Faturayı İndir"},"invoice"),e.jsx(N,{type:"primary",icon:e.jsx(H,{}),onClick:()=>R("/login"),children:"Panele Git"},"console")]});return s?e.jsxs("div",{className:"payment-page",children:[e.jsx("div",{className:"payment-header",children:e.jsxs("div",{className:"container",children:[e.jsxs(l,{size:"large",children:[e.jsx("img",{src:"/logo.png",alt:"Stocker",style:{height:40}}),e.jsx(x,{level:3,style:{margin:0,color:"#fff"},children:"Güvenli Ödeme"})]}),e.jsxs(l,{children:[e.jsx(E,{style:{fontSize:24,color:"#52c41a"}}),e.jsx(a,{style:{color:"#fff"},children:"256-bit SSL Güvenlik"})]})]})}),e.jsx("div",{className:"payment-content",children:e.jsxs("div",{className:"container",children:[e.jsx(Z,{current:A,style:{marginBottom:32},items:[{title:"Ödeme Bilgileri",icon:e.jsx(w,{})},{title:"Doğrulama",icon:e.jsx(F,{})},{title:"Tamamlandı",icon:e.jsx(H,{})}]}),se?Se():e.jsx(e.Fragment,{children:e.jsxs(D,{activeKey:$,onChange:r=>T(r),size:"large",children:[e.jsx(L,{tab:e.jsxs(l,{children:[e.jsx(w,{}),"Kredi/Banka Kartı"]}),children:be()},"credit_card"),e.jsx(L,{tab:e.jsxs(l,{children:[e.jsx(ze,{}),"Havale/EFT"]}),children:e.jsxs(o,{children:[e.jsx(b,{message:"Banka Havalesi Bilgileri",description:"Aşağıdaki hesap bilgilerine havale/EFT yapabilirsiniz.",type:"info",showIcon:!0,style:{marginBottom:24}}),e.jsx(W,{dataSource:[{bank:"Garanti BBVA",iban:"TR12 0006 2000 1234 0006 2345 67",branch:"Levent Şubesi"},{bank:"İş Bankası",iban:"TR34 0006 4000 0011 2345 6789 00",branch:"Maslak Şubesi"},{bank:"Akbank",iban:"TR56 0004 6000 5888 8000 1234 56",branch:"Sarıyer Şubesi"}],renderItem:r=>e.jsx(W.Item,{children:e.jsx(o,{style:{width:"100%"},children:e.jsxs(l,{direction:"vertical",style:{width:"100%"},children:[e.jsx(a,{strong:!0,children:r.bank}),e.jsx(a,{copyable:!0,children:r.iban}),e.jsx(a,{type:"secondary",children:r.branch})]})})})}),e.jsx(b,{message:"Önemli",description:`Açıklama kısmına "${s.companyName} - ${_}" yazınız.`,type:"warning",style:{marginTop:16}})]})},"bank_transfer"),e.jsx(L,{tab:e.jsxs(l,{children:[e.jsx(Q,{}),"Dijital Cüzdan"]}),children:e.jsx(o,{children:e.jsx(k,{gutter:[16,16],children:["PayPal","Apple Pay","Google Pay","BKM Express"].map(r=>e.jsx(m,{span:12,children:e.jsx(o,{hoverable:!0,className:"wallet-card",onClick:()=>y.info(`${r} ile ödeme simülasyonu`),children:e.jsxs(l,{direction:"vertical",align:"center",style:{width:"100%"},children:[e.jsx(Q,{style:{fontSize:48,color:"#1890ff"}}),e.jsx(a,{strong:!0,children:r})]})})},r))})})},"digital_wallet")]})})]})}),ke()]}):e.jsx("div",{style:{textAlign:"center",padding:100},children:e.jsx(Te,{size:"large"})})};export{Qe as PaymentPage};
