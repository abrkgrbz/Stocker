var a=(a,e,s)=>new Promise((i,r)=>{var l=a=>{try{t(s.next(a))}catch(e){r(e)}},n=a=>{try{t(s.throw(a))}catch(e){r(e)}},t=a=>a.done?i(a.value):Promise.resolve(a.value).then(l,n);t((s=s.apply(a,e)).next())});import{au as e,j as s,O as i,t as r,G as l,a5 as n,v as t,I as o,ar as c,av as d}from"./chunk-Bf7f0GK8.js";import{m as u,u as m,r as f}from"./chunk-nBmrMGrr.js";import{a as y}from"../index-BwqpPS9r.js";import"./chunk-BsETiAjl.js";const{Title:g,Paragraph:v}=l,h=()=>{const[l]=u(),h=m(),[p,x]=f.useState("pending"),[j,k]=f.useState(""),[E,b]=f.useState(!1),[G,T]=f.useState(0),z=l.get("email"),D=l.get("token");f.useEffect(()=>{z&&D?S():(x("error"),k("Geçersiz doğrulama linki"))},[z,D]),f.useEffect(()=>{if(G>0){const a=setTimeout(()=>{T(G-1)},1e3);return()=>clearTimeout(a)}},[G]);const S=()=>a(null,null,function*(){var a,s;if(z&&D)try{const a=yield y.verifyEmail({email:z,token:D});a.data.success?(x("success"),e.success(a.data.message||"Email başarıyla doğrulandı!"),setTimeout(()=>{h(a.data.redirectUrl||"/login")},3e3)):(x("error"),k(a.data.message||"Doğrulama başarısız"))}catch(i){x("error"),k((null==(s=null==(a=i.response)?void 0:a.data)?void 0:s.message)||"Doğrulama sırasında bir hata oluştu")}}),C=()=>{h("/login")};return s.jsx("div",{className:"email-verification-container",children:s.jsxs(i,{className:"email-verification-card",children:["pending"===p&&s.jsxs("div",{className:"verification-loading",children:[s.jsx(r,{size:"large"}),s.jsx(g,{level:3,children:"Email Doğrulanıyor..."}),s.jsx(v,{children:"Lütfen bekleyin, email adresiniz doğrulanıyor."})]}),"success"===p&&s.jsx(n,{status:"success",icon:s.jsx(o,{style:{color:"#52c41a"}}),title:"Email Başarıyla Doğrulandı!",subTitle:"Hesabınız aktifleştirildi. Giriş sayfasına yönlendiriliyorsunuz...",extra:[s.jsx(t,{type:"primary",onClick:C,children:"Hemen Giriş Yap"},"login")]}),"error"===p&&s.jsx(n,{status:"error",icon:s.jsx(d,{style:{color:"#ff4d4f"}}),title:"Doğrulama Başarısız",subTitle:j,extra:[z&&s.jsx(t,{type:"primary",icon:s.jsx(c,{}),loading:E,disabled:G>0,onClick:()=>a(null,null,function*(){var a,s,i,r,l;if(!(!z||E||G>0)){b(!0);try{const a=yield y.resendVerificationEmail({email:z});a.data.success?(e.success(a.data.message||"Doğrulama emaili tekrar gönderildi"),T(60)):e.error(a.data.message||"Email gönderilemedi")}catch(n){if(null==(i=null==(s=null==(a=n.response)?void 0:a.data)?void 0:s.message)?void 0:i.includes("saniye sonra")){const a=n.response.data.message.match(/(\d+) saniye/);a&&T(parseInt(a[1]))}e.error((null==(l=null==(r=n.response)?void 0:r.data)?void 0:l.message)||"Email gönderilemedi")}finally{b(!1)}}}),children:G>0?`Tekrar Gönder (${G}s)`:"Doğrulama Emailini Tekrar Gönder"},"resend"),s.jsx(t,{onClick:C,children:"Giriş Sayfasına Git"},"login")]})]})})};export{h as default};
