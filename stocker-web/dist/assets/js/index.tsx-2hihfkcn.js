var a=(a,e,s)=>new Promise((i,r)=>{var l=a=>{try{t(s.next(a))}catch(e){r(e)}},n=a=>{try{t(s.throw(a))}catch(e){r(e)}},t=a=>a.done?i(a.value):Promise.resolve(a.value).then(l,n);t((s=s.apply(a,e)).next())});import{am as e,j as s,O as i,t as r,F as l,u as n,v as t,_ as o,aj as c,w as d}from"./chunk-C1XaOcCX.js";import{m as u,u as m,r as f}from"./chunk-nBmrMGrr.js";import{a as y}from"../index-C99TdBTD.js";import"./chunk-BsETiAjl.js";const{Title:g,Paragraph:v}=l,h=()=>{const[l]=u(),h=m(),[j,p]=f.useState("pending"),[x,k]=f.useState(""),[E,b]=f.useState(!1),[T,z]=f.useState(0),D=l.get("email"),G=l.get("token");f.useEffect(()=>{D&&G?S():(p("error"),k("Geçersiz doğrulama linki"))},[D,G]),f.useEffect(()=>{if(T>0){const a=setTimeout(()=>{z(T-1)},1e3);return()=>clearTimeout(a)}},[T]);const S=()=>a(null,null,function*(){var a,s;if(D&&G)try{const a=yield y.verifyEmail({email:D,token:G});a.data.success?(p("success"),e.success(a.data.message||"Email başarıyla doğrulandı!"),setTimeout(()=>{h(a.data.redirectUrl||"/login")},3e3)):(p("error"),k(a.data.message||"Doğrulama başarısız"))}catch(i){p("error"),k((null==(s=null==(a=i.response)?void 0:a.data)?void 0:s.message)||"Doğrulama sırasında bir hata oluştu")}}),w=()=>{h("/login")};return s.jsx("div",{className:"email-verification-container",children:s.jsxs(i,{className:"email-verification-card",children:["pending"===j&&s.jsxs("div",{className:"verification-loading",children:[s.jsx(r,{size:"large"}),s.jsx(g,{level:3,children:"Email Doğrulanıyor..."}),s.jsx(v,{children:"Lütfen bekleyin, email adresiniz doğrulanıyor."})]}),"success"===j&&s.jsx(n,{status:"success",icon:s.jsx(o,{style:{color:"#52c41a"}}),title:"Email Başarıyla Doğrulandı!",subTitle:"Hesabınız aktifleştirildi. Giriş sayfasına yönlendiriliyorsunuz...",extra:[s.jsx(t,{type:"primary",onClick:w,children:"Hemen Giriş Yap"},"login")]}),"error"===j&&s.jsx(n,{status:"error",icon:s.jsx(d,{style:{color:"#ff4d4f"}}),title:"Doğrulama Başarısız",subTitle:x,extra:[D&&s.jsx(t,{type:"primary",icon:s.jsx(c,{}),loading:E,disabled:T>0,onClick:()=>a(null,null,function*(){var a,s,i,r,l;if(!(!D||E||T>0)){b(!0);try{const a=yield y.resendVerificationEmail({email:D});a.data.success?(e.success(a.data.message||"Doğrulama emaili tekrar gönderildi"),z(60)):e.error(a.data.message||"Email gönderilemedi")}catch(n){if(null==(i=null==(s=null==(a=n.response)?void 0:a.data)?void 0:s.message)?void 0:i.includes("saniye sonra")){const a=n.response.data.message.match(/(\d+) saniye/);a&&z(parseInt(a[1]))}e.error((null==(l=null==(r=n.response)?void 0:r.data)?void 0:l.message)||"Email gönderilemedi")}finally{b(!1)}}}),children:T>0?`Tekrar Gönder (${T}s)`:"Doğrulama Emailini Tekrar Gönder"},"resend"),s.jsx(t,{onClick:w,children:"Giriş Sayfasına Git"},"login")]})]})})};export{h as default};
