var n=Object.defineProperty,t=Object.defineProperties,i=Object.getOwnPropertyDescriptors,e=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,l=(t,i,e)=>i in t?n(t,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[i]=e,s=(n,t,i)=>l(n,"symbol"!=typeof t?t+"":t,i),c=(n,t,i)=>new Promise((e,o)=>{var a=n=>{try{s(i.next(n))}catch(t){o(t)}},l=n=>{try{s(i.throw(n))}catch(t){o(t)}},s=n=>n.done?e(n.value):Promise.resolve(n.value).then(a,l);s((i=i.apply(n,t)).next())});import{r}from"./chunk-nBmrMGrr.js";import{A as d}from"../index-DQn1oUae.js";import{H as h,a as u,b as C,L as m}from"./chunk-FkXcRIdw.js";const k=new class{constructor(){s(this,"validationConnection",null),s(this,"notificationConnection",null),s(this,"baseUrl",d)}startValidationConnection(){return c(this,null,function*(){var n;if((null==(n=this.validationConnection)?void 0:n.state)!==h.Connected){this.validationConnection=(new u).withUrl(`${this.baseUrl}/hubs/validation`,{transport:C.LongPolling}).withAutomaticReconnect([0,2e3,5e3,1e4,3e4]).configureLogging(m.Debug).build(),this.validationConnection.onreconnecting(()=>{}),this.validationConnection.onreconnected(()=>{}),this.validationConnection.onclose(()=>{});try{yield this.validationConnection.start()}catch(t){throw t}}})}startNotificationConnection(n){return c(this,null,function*(){var s;if((null==(s=this.notificationConnection)?void 0:s.state)===h.Connected)return;const c={withCredentials:!0};var r,d;n&&(c.accessTokenFactory=()=>n),this.notificationConnection=(new u).withUrl(`${this.baseUrl}/hubs/notification`,(r=((n,t)=>{for(var i in t||(t={}))o.call(t,i)&&l(n,i,t[i]);if(e)for(var i of e(t))a.call(t,i)&&l(n,i,t[i]);return n})({},c),d={transport:C.LongPolling},t(r,i(d)))).withAutomaticReconnect([0,2e3,5e3,1e4,3e4]).configureLogging(m.Debug).build(),this.notificationConnection.onreconnecting(()=>{}),this.notificationConnection.onreconnected(()=>{}),this.notificationConnection.onclose(()=>{});try{yield this.notificationConnection.start()}catch(k){throw k}})}validateEmail(n){return c(this,null,function*(){return this.validationConnection&&this.validationConnection.state===h.Connected||(yield this.startValidationConnection()),this.validationConnection.invoke("ValidateEmail",n)})}onEmailValidated(n){var t;null==(t=this.validationConnection)||t.on("EmailValidated",n)}checkPasswordStrength(n){return c(this,null,function*(){return this.validationConnection&&this.validationConnection.state===h.Connected||(yield this.startValidationConnection()),this.validationConnection.invoke("CheckPasswordStrength",n)})}onPasswordStrengthChecked(n){var t;null==(t=this.validationConnection)||t.on("PasswordStrengthChecked",n)}checkDomain(n){return c(this,null,function*(){return this.validationConnection&&this.validationConnection.state===h.Connected||(yield this.startValidationConnection()),this.validationConnection.invoke("CheckDomain",n)})}onDomainChecked(n){var t;null==(t=this.validationConnection)||t.on("DomainChecked",n)}validatePhone(n,t="TR"){return c(this,null,function*(){return this.validationConnection&&this.validationConnection.state===h.Connected||(yield this.startValidationConnection()),this.validationConnection.invoke("ValidatePhone",n,t)})}onPhoneValidated(n){var t;null==(t=this.validationConnection)||t.on("PhoneValidated",n)}checkCompanyName(n){return c(this,null,function*(){return this.validationConnection&&this.validationConnection.state===h.Connected||(yield this.startValidationConnection()),this.validationConnection.invoke("CheckCompanyName",n)})}onCompanyNameChecked(n){var t;null==(t=this.validationConnection)||t.on("CompanyNameChecked",n)}validateIdentity(n){return c(this,null,function*(){return this.validationConnection&&this.validationConnection.state===h.Connected||(yield this.startValidationConnection()),this.validationConnection.invoke("ValidateIdentity",n)})}onIdentityValidated(n){var t;null==(t=this.validationConnection)||t.on("IdentityValidated",n)}onNotificationReceived(n){var t;null==(t=this.notificationConnection)||t.on("ReceiveNotification",n)}onConnected(n){var t,i;null==(t=this.validationConnection)||t.on("Connected",n),null==(i=this.notificationConnection)||i.on("Connected",n)}onValidationError(n){var t;null==(t=this.validationConnection)||t.on("ValidationError",n)}stopValidationConnection(){return c(this,null,function*(){this.validationConnection&&(yield this.validationConnection.stop(),this.validationConnection=null)})}stopNotificationConnection(){return c(this,null,function*(){this.notificationConnection&&(yield this.notificationConnection.stop(),this.notificationConnection=null)})}stopAllConnections(){return c(this,null,function*(){yield this.stopValidationConnection(),yield this.stopNotificationConnection()})}};const f=new class{constructor(){s(this,"emailCallbacks",[]),s(this,"passwordCallbacks",[]),s(this,"domainCallbacks",[]),s(this,"phoneCallbacks",[]),s(this,"companyCallbacks",[]),s(this,"identityCallbacks",[]),s(this,"notificationCallbacks",[]),s(this,"connectedCallbacks",[]),s(this,"errorCallbacks",[])}startValidationConnection(){return c(this,null,function*(){yield new Promise(n=>setTimeout(n,500)),this.connectedCallbacks.forEach(n=>n({connectionId:"mock-connection-id"}))})}startNotificationConnection(n){return c(this,null,function*(){yield new Promise(n=>setTimeout(n,500)),this.connectedCallbacks.forEach(t=>t({connectionId:"mock-notification-id",token:n}))})}validateEmail(n){return c(this,null,function*(){setTimeout(()=>{const t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n),i={isValid:t,message:t?"Email adresi geçerli":"Geçersiz email formatı",details:{format:t?"valid":"invalid",domain:n.split("@")[1]||"",suggestion:t||n.includes("@")?"":"@ işareti eksik"}};this.emailCallbacks.forEach(n=>n(i))},300)})}onEmailValidated(n){this.emailCallbacks.push(n)}checkPasswordStrength(n){return c(this,null,function*(){setTimeout(()=>{let t=0;const i=[];n.length>=8?t++:i.push("En az 8 karakter kullanın"),n.length>=12&&t++,/[A-Z]/.test(n)?t++:i.push("Büyük harf ekleyin"),/[a-z]/.test(n)?t++:i.push("Küçük harf ekleyin"),/\d/.test(n)?t++:i.push("Rakam ekleyin"),/[!@#$%^&*(),.?":{}|<>]/.test(n)?t++:i.push("Özel karakter ekleyin (!@#$%^&*)");const e=Math.min(Math.floor(t/1.5),4),o={score:Math.min(t,5),level:["VeryWeak","Weak","Fair","Strong","VeryStrong"][e],color:["#ff4d4f","#faad14","#fadb14","#52c41a","#389e0d"][e],suggestions:i};this.passwordCallbacks.forEach(n=>n(o))},200)})}onPasswordStrengthChecked(n){this.passwordCallbacks.push(n)}checkDomain(n){return c(this,null,function*(){setTimeout(()=>{const t=!["test.stocker.app","demo.stocker.app","example.stocker.app"].includes(n.toLowerCase()),i=n.split(".")[0],e={isAvailable:t,message:t?"Domain kullanılabilir":"Bu domain zaten kullanılıyor",suggestions:t?[]:[`${i}1.stocker.app`,`${i}-company.stocker.app`,`${i}2024.stocker.app`]};this.domainCallbacks.forEach(n=>n(e))},400)})}onDomainChecked(n){this.domainCallbacks.push(n)}validatePhone(n,t="TR"){return c(this,null,function*(){setTimeout(()=>{const i=n.replace(/\D/g,""),e="TR"===t?/^(90)?5\d{9}$/.test(i)||/^5\d{9}$/.test(i):i.length>=10,o={isValid:e,message:e?"Telefon numarası geçerli":"Geçersiz telefon numarası formatı",details:{countryCode:t,format:e?"valid":"invalid",suggestion:"TR"!==t||e?"":"Türkiye telefon numarası 5XX XXX XX XX formatında olmalı"}};this.phoneCallbacks.forEach(n=>n(o))},300)})}onPhoneValidated(n){this.phoneCallbacks.push(n)}checkCompanyName(n){return c(this,null,function*(){setTimeout(()=>{const t=!["ABC Teknoloji","XYZ Yazılım","Test Company"].some(t=>t.toLowerCase()===n.toLowerCase()),i={isValid:t,message:t?"Şirket adı kullanılabilir":"Bu şirket adı zaten kayıtlı",details:{available:t?"yes":"no",suggestion:t?"":"Şirket adına bir numara veya ayırt edici kelime ekleyin"}};this.companyCallbacks.forEach(n=>n(i))},350)})}onCompanyNameChecked(n){this.companyCallbacks.push(n)}validateIdentity(n){return c(this,null,function*(){setTimeout(()=>{const t=n.replace(/\D/g,"");let i=!1,e="",o="";if(11===t.length){e="TCKimlik";i=0!==parseInt(t[0])&&/^\d{11}$/.test(t),o=i?"TC Kimlik numarası geçerli":"Geçersiz TC Kimlik numarası"}else 10===t.length?(e="VergiNo",i=/^\d{10}$/.test(t),o=i?"Vergi numarası geçerli":"Geçersiz Vergi numarası"):o="Kimlik/Vergi numarası 10 veya 11 haneli olmalıdır";const a={isValid:i,message:o,details:{numberType:e,formattedNumber:t,length:t.length.toString()}};this.identityCallbacks.forEach(n=>n(a))},400)})}onIdentityValidated(n){this.identityCallbacks.push(n)}onNotificationReceived(n){this.notificationCallbacks.push(n),setTimeout(()=>{n({id:"mock-1",title:"Hoş Geldiniz",message:"SignalR Mock Service aktif",type:"Info",priority:"Normal",createdAt:new Date,icon:"info"})},2e3)}onConnected(n){this.connectedCallbacks.push(n)}onValidationError(n){this.errorCallbacks.push(n)}stopValidationConnection(){return c(this,null,function*(){this.emailCallbacks=[],this.passwordCallbacks=[],this.domainCallbacks=[],this.phoneCallbacks=[],this.companyCallbacks=[],this.identityCallbacks=[],this.connectedCallbacks=[],this.errorCallbacks=[]})}stopNotificationConnection(){return c(this,null,function*(){this.notificationCallbacks=[]})}stopAllConnections(){return c(this,null,function*(){yield this.stopValidationConnection(),yield this.stopNotificationConnection()})}},p=()=>{const[n,t]=r.useState(!1),[i,e]=r.useState(null),[o,a]=r.useState(null),[l,s]=r.useState(null),[d,h]=r.useState(null),[u,C]=r.useState(null),[m,p]=r.useState(null),[v,y]=r.useState(null),[b,g]=r.useState(!1);r.useEffect(()=>(c(null,null,function*(){const n=b?f:k;try{b?yield f.startValidationConnection():yield k.startValidationConnection(),t(!0),n.onEmailValidated(n=>{e(n)}),n.onPasswordStrengthChecked(n=>{a(n)}),n.onDomainChecked(n=>{s(n)}),n.onPhoneValidated(n=>{h(n)}),n.onCompanyNameChecked(n=>{C(n)}),n.onIdentityValidated(n=>{p(n)}),n.onValidationError(n=>{y(n)}),n.onConnected(()=>{})}catch(i){b?(y("Failed to connect to validation service"),t(!1)):(g(!0),y("Using mock validation service (API not available)"))}}),()=>{b?f.stopValidationConnection():k.stopValidationConnection()}),[b]);const V=b?f:k;return{isConnected:n,emailValidation:i,passwordStrength:o,domainCheck:l,phoneValidation:d,companyNameCheck:u,identityValidation:m,error:v,validateEmail:r.useCallback(n=>c(null,null,function*(){y(null),e(null);try{yield V.validateEmail(n)}catch(t){y("Failed to validate email")}}),[V]),checkPasswordStrength:r.useCallback(n=>c(null,null,function*(){y(null),a(null);try{yield V.checkPasswordStrength(n)}catch(t){y("Failed to check password strength")}}),[V]),checkDomain:r.useCallback(n=>c(null,null,function*(){y(null),s(null);try{yield V.checkDomain(n)}catch(t){y("Failed to check domain")}}),[V]),validatePhone:r.useCallback((n,t="TR")=>c(null,null,function*(){y(null),h(null);try{yield V.validatePhone(n,t)}catch(i){y("Failed to validate phone")}}),[V]),checkCompanyName:r.useCallback(n=>c(null,null,function*(){y(null),C(null);try{yield V.checkCompanyName(n)}catch(t){y("Failed to check company name")}}),[V]),validateIdentity:r.useCallback(n=>c(null,null,function*(){y(null),p(null);try{yield V.validateIdentity(n)}catch(t){y("Failed to validate identity number")}}),[V])}};export{p as u};
