var D=Object.defineProperty,R=Object.defineProperties;var E=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var v=(i,s,a)=>s in i?D(i,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[s]=a,z=(i,s)=>{for(var a in s||(s={}))F.call(s,a)&&v(i,a,s[a]);if(b)for(var a of b(s))G.call(s,a)&&v(i,a,s[a]);return i},I=(i,s)=>R(i,E(s));var l=(i,s,a)=>new Promise((u,c)=>{var x=n=>{try{m(a.next(n))}catch(d){c(d)}},r=n=>{try{m(a.throw(n))}catch(d){c(d)}},m=n=>n.done?u(n.value):Promise.resolve(n.value).then(x,r);m((a=a.apply(i,s)).next())});import{ag as p,j as e,G as Y,F as K,ah as j,ai as $,aj as B,J as q,v as H,ak as O,S as P}from"./chunk-CQugYT0Y.js";import{u as L}from"../index-BEW7Pg8Q.js";import{a as y}from"./chunk-B1KqMBAo.js";import{s as g,S as A,a as V}from"./chunk-B8EagpWf.js";import{u as J,i as M}from"./chunk-a6Wk6XzP.js";import"./chunk-CX9aqCgN.js";class X{createCompany(s){return l(this,null,function*(){return(yield y.post("/api/companies",I(z({},s),{address:{country:s.country,city:s.city,district:s.district,postalCode:s.postalCode,addressLine:s.addressLine},foundedDate:s.foundedYear?new Date(s.foundedYear,0,1).toISOString():new Date().toISOString()}))).data})}getCompany(){return l(this,null,function*(){try{return(yield y.get("/api/companies/current")).data}catch(s){return null}})}updateCompany(s,a){return l(this,null,function*(){return(yield y.put(`/api/companies/${s}`,a)).data})}checkCompanyExists(){return l(this,null,function*(){try{return!!(yield this.getCompany())}catch(s){return!1}})}uploadLogo(s){return l(this,null,function*(){const a=new FormData;return a.append("logo",s),(yield y.post("/api/companies/logo",a,{headers:{"Content-Type":"multipart/form-data"}})).data})}}const Q=new X,{Title:U,Text:o}=K,ne=()=>{const i=J(),s=M(),{login:a,isLoading:u}=L(),[c]=p.useForm(),x=r=>l(null,null,function*(){var m,n,d,N,k,S;g.loading("Giriş yapılıyor...");try{r.tenantCode&&localStorage.setItem("X-Tenant-Code",r.tenantCode);const t={email:r.email,password:r.password,tenantCode:r.tenantCode};yield a(t),A.close();const f=L.getState(),T=((m=f.user)==null?void 0:m.firstName)||((n=f.user)==null?void 0:n.email)||"Kullanıcı";yield V(T);const h=(N=(d=f.user)==null?void 0:d.roles)==null?void 0:N[0],w=(S=(k=s.state)==null?void 0:k.from)==null?void 0:S.pathname;if(h!=="SystemAdmin")try{if(!(yield Q.checkCompanyExists())){g.info("Şirket bilgilerinizi tamamlamanız gerekiyor. Yönlendiriliyorsunuz...","Şirket Kurulumu"),setTimeout(()=>{i("/company-setup",{replace:!0})},2e3);return}}catch(C){console.log("Company check skipped:",C)}setTimeout(()=>{w?i(w,{replace:!0}):h==="SystemAdmin"?i("/master",{replace:!0}):h==="TenantAdmin"||h==="Admin"?i("/admin",{replace:!0}):i("/app/default",{replace:!0})},1500)}catch(t){A.close(),console.error("Login error:",t),t.response?g.error(t,"Giriş başarısız"):t.message?g.error({response:{data:{message:t.message}}},"Giriş başarısız"):g.error({response:{data:{message:"Beklenmeyen bir hata oluştu. Lütfen tekrar deneyin."}}},"Giriş başarısız")}});return e.jsxs("div",{className:"login-page",children:[e.jsxs("div",{className:"login-background",children:[e.jsx("div",{className:"login-bg-shape login-bg-shape-1"}),e.jsx("div",{className:"login-bg-shape login-bg-shape-2"}),e.jsx("div",{className:"login-bg-shape login-bg-shape-3"}),e.jsx("div",{className:"login-bg-shape login-bg-shape-4"})]}),e.jsx("div",{className:"login-container",children:e.jsxs("div",{className:"login-box",children:[e.jsx("div",{className:"login-logo",children:e.jsx(Y,{style:{fontSize:48,color:"#667eea"}})}),e.jsxs("div",{className:"login-header",children:[e.jsx(U,{level:2,style:{margin:0,color:"#1a1a1a"},children:"Hoş Geldiniz"}),e.jsx(o,{type:"secondary",style:{fontSize:16},children:"Stocker'a devam etmek için giriş yapın"})]}),e.jsxs(p,{form:c,name:"login",onFinish:x,layout:"vertical",size:"large",className:"login-form",children:[e.jsx(p.Item,{name:"tenantCode",rules:[{required:!1,message:"Lütfen kiracı kodunu girin!"}],children:e.jsx(j,{prefix:e.jsx($,{style:{color:"#667eea"}}),placeholder:"Kiracı Kodu (örn: test)",autoComplete:"organization",className:"login-input"})}),e.jsx(p.Item,{name:"email",rules:[{required:!0,message:"Lütfen email adresinizi girin!"},{type:"email",message:"Lütfen geçerli bir email adresi girin!"}],children:e.jsx(j,{prefix:e.jsx(B,{style:{color:"#667eea"}}),placeholder:"Email adresi",autoComplete:"email",type:"email",className:"login-input"})}),e.jsx(p.Item,{name:"password",rules:[{required:!0,message:"Lütfen şifrenizi girin!"}],children:e.jsx(j.Password,{prefix:e.jsx(q,{style:{color:"#667eea"}}),placeholder:"Şifre",autoComplete:"current-password",className:"login-input"})}),e.jsx(p.Item,{style:{marginBottom:16},children:e.jsx(H,{type:"primary",htmlType:"submit",loading:u,block:!0,size:"large",icon:e.jsx(O,{}),className:"login-button",children:"Giriş Yap"})}),e.jsxs("div",{className:"login-links",children:[e.jsx("a",{href:"/forgot-password",children:"Şifremi unuttum"}),e.jsx("span",{className:"separator",children:"•"}),e.jsx("a",{href:"/register",children:"Hesap oluştur"})]})]}),e.jsxs("div",{className:"demo-section",children:[e.jsx(o,{type:"secondary",style:{fontSize:12,textAlign:"center",display:"block",marginBottom:12},children:"DEMO HESAPLARI"}),e.jsxs(P,{direction:"vertical",style:{width:"100%"},size:"small",children:[e.jsxs("div",{className:"demo-credential",onClick:()=>{c.setFieldsValue({email:"admin@stocker.com",password:"Admin@123456"})},children:[e.jsx("div",{className:"demo-icon",children:"👨‍💼"}),e.jsxs("div",{className:"demo-info",children:[e.jsx(o,{strong:!0,style:{fontSize:13},children:"Sistem Yöneticisi"}),e.jsx(o,{type:"secondary",style:{fontSize:11,display:"block"},children:"admin@stocker.com"})]}),e.jsx(o,{className:"demo-hint",children:"Doldurmak için tıkla"})]}),e.jsxs("div",{className:"demo-credential",onClick:()=>{c.setFieldsValue({email:"tenant@example.com",password:"Tenant@123456"})},children:[e.jsx("div",{className:"demo-icon",children:"👤"}),e.jsxs("div",{className:"demo-info",children:[e.jsx(o,{strong:!0,style:{fontSize:13},children:"Kiracı Yöneticisi"}),e.jsx(o,{type:"secondary",style:{fontSize:11,display:"block"},children:"tenant@example.com"})]}),e.jsx(o,{className:"demo-hint",children:"Doldurmak için tıkla"})]})]})]})]})})]})};export{ne as LoginPage};
