var e=Object.defineProperty,l=Object.defineProperties,r=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,t=(l,r,a)=>r in l?e(l,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[r]=a,n=(e,l,r)=>new Promise((a,i)=>{var s=e=>{try{n(r.next(e))}catch(l){i(l)}},t=e=>{try{n(r.throw(e))}catch(l){i(l)}},n=e=>e.done?a(e.value):Promise.resolve(e.value).then(s,t);n((r=r.apply(e,l)).next())});import{ag as c,am as d,j as o,S as m,v as u,b1 as x,bu as h,M as j,N as p,O as f,aT as y,i as v,_ as b,R as g,a5 as k,ah as S,b7 as A,a_ as w,aW as T,aO as D,aj as N,aB as Y,Y as P,ba as I,an as z,aK as K,b9 as C,A as F,aE as M,T as L,F as O,Z as E,aX as G,b5 as V,e as X,aF as H,b2 as q,bd as R,J as B,be as W,b6 as $,D as _,bc as J,B as U}from"./chunk-Cnyct2Bi.js";import{r as Z}from"./chunk-nBmrMGrr.js";import{P as Q}from"./chunk-BZpOPqTx.js";import{b as ee,f as le}from"./chunk-Z2k4PS2b.js";import{f as re}from"./chunk-CZ40riKv.js";import"../index-aqMOFn5z.js";import"./chunk-BsETiAjl.js";const{Title:ae,Text:ie,Paragraph:se}=O,{Option:te}=w,{TabPane:ne}=K,ce=()=>{const[e,O]=Z.useState([]),[se,ce]=Z.useState(!1),[de,oe]=Z.useState(""),[me,ue]=Z.useState("all"),[xe,he]=Z.useState("all"),[je,pe]=Z.useState(null),[fe,ye]=Z.useState(!1),[ve,be]=Z.useState(!1),[ge,ke]=Z.useState(!1),[Se,Ae]=Z.useState(null),[we]=c.useForm(),[Te]=c.useForm(),De=[{id:"1",email:"admin@company.com",firstName:"Ahmet",lastName:"Yılmaz",fullName:"Ahmet Yılmaz",phoneNumber:"+90 532 111 2233",role:"Admin",department:"Yönetim",title:"Genel Müdür",isActive:!0,emailVerified:!0,lastLogin:"2024-01-15T10:30:00",createdAt:"2023-06-01T00:00:00",permissions:["users.create","users.edit","users.delete","invoices.*","settings.*"]},{id:"2",email:"muhasebe@company.com",firstName:"Ayşe",lastName:"Demir",fullName:"Ayşe Demir",phoneNumber:"+90 533 444 5566",role:"Accountant",department:"Muhasebe",title:"Muhasebe Uzmanı",isActive:!0,emailVerified:!0,lastLogin:"2024-01-15T09:15:00",createdAt:"2023-07-15T00:00:00",permissions:["invoices.*","reports.view"]},{id:"3",email:"satis@company.com",firstName:"Mehmet",lastName:"Kaya",fullName:"Mehmet Kaya",phoneNumber:"+90 534 777 8899",role:"Sales",department:"Satış",title:"Satış Temsilcisi",isActive:!0,emailVerified:!1,lastLogin:"2024-01-14T16:45:00",createdAt:"2023-09-01T00:00:00",permissions:["customers.*","orders.create","orders.view"]},{id:"4",email:"depo@company.com",firstName:"Fatma",lastName:"Öz",fullName:"Fatma Öz",phoneNumber:"+90 535 222 3344",role:"Staff",department:"Depo",title:"Depo Sorumlusu",isActive:!1,emailVerified:!0,lastLogin:"2024-01-10T11:20:00",createdAt:"2023-10-01T00:00:00",permissions:["inventory.*"]}];Z.useEffect(()=>{Ne()},[]);const Ne=()=>n(null,null,function*(){ce(!0);try{setTimeout(()=>{O(De),ce(!1)},1e3)}catch(e){d.error("Kullanıcılar yüklenemedi"),ce(!1)}}),Ye=e=>{var n;Ae(e),we.setFieldsValue((n=((e,l)=>{for(var r in l||(l={}))i.call(l,r)&&t(e,r,l[r]);if(a)for(var r of a(l))s.call(l,r)&&t(e,r,l[r]);return e})({},e),l(n,r({sendWelcomeEmail:!1})))),ye(!0)},Pe=e=>({Admin:"red",Accountant:"blue",Sales:"green",Staff:"default",Manager:"purple"}[e]||"default"),Ie=e=>e?o.jsx(U,{status:"success",text:"Aktif"}):o.jsx(U,{status:"error",text:"Pasif"}),ze=[{title:"Kullanıcı",key:"user",fixed:"left",width:280,render:(e,l)=>o.jsxs(m,{children:[o.jsxs(F,{size:40,style:{backgroundColor:"#667eea"},icon:o.jsx(X,{}),children:[l.firstName[0],l.lastName[0]]}),o.jsxs("div",{children:[o.jsxs("div",{children:[o.jsx(ie,{strong:!0,children:l.fullName}),!l.emailVerified&&o.jsx(H,{title:"E-posta doğrulanmamış",children:o.jsx(M,{style:{color:"#faad14",marginLeft:8}})})]}),o.jsx(ie,{type:"secondary",style:{fontSize:12},children:l.email})]})]})},{title:"Rol",dataIndex:"role",key:"role",width:120,filters:[{text:"Admin",value:"Admin"},{text:"Muhasebe",value:"Accountant"},{text:"Satış",value:"Sales"},{text:"Personel",value:"Staff"}],render:e=>o.jsx(L,{color:Pe(e),children:"Admin"===e?"Yönetici":"Accountant"===e?"Muhasebe":"Sales"===e?"Satış":"Staff"===e?"Personel":e})},{title:"Departman",dataIndex:"department",key:"department",width:120,render:e=>e||"-"},{title:"Ünvan",dataIndex:"title",key:"title",width:150,ellipsis:!0,render:e=>e||"-"},{title:"Telefon",dataIndex:"phoneNumber",key:"phoneNumber",width:140,render:e=>ee(e)||"-"},{title:"Son Giriş",dataIndex:"lastLogin",key:"lastLogin",width:150,sorter:!0,render:e=>e?o.jsx(H,{title:le(e,"DD.MM.YYYY HH:mm"),children:le(e,"DD.MM.YYYY")}):"-"},{title:"Durum",dataIndex:"isActive",key:"isActive",width:100,filters:[{text:"Aktif",value:!0},{text:"Pasif",value:!1}],render:e=>Ie(e)},{title:"İşlemler",key:"actions",fixed:"right",width:120,render:(e,l)=>{const r=[{key:"view",label:"Detayları Gör",icon:o.jsx(q,{}),onClick:()=>(pe(l),void be(!0))},{key:"edit",label:"Düzenle",icon:o.jsx(V,{}),onClick:()=>Ye(l)},{key:"password",label:"Şifre Değiştir",icon:o.jsx(R,{}),onClick:()=>(pe(l),Te.resetFields(),void ke(!0))},{type:"divider"},{key:"toggle",label:l.isActive?"Pasifleştir":"Aktifleştir",icon:l.isActive?o.jsx(B,{}):o.jsx(W,{}),onClick:()=>{return l.id,e=!l.isActive,n(null,null,function*(){try{d.success(e?"Kullanıcı aktifleştirildi":"Kullanıcı pasifleştirildi"),Ne()}catch(l){d.error("İşlem başarısız")}});var e}},{key:"delete",label:"Sil",icon:o.jsx($,{}),danger:!0,onClick:()=>{D.confirm({title:"Kullanıcıyı Sil",content:`${l.fullName} adlı kullanıcıyı silmek istediğinizden emin misiniz?`,okText:"Sil",cancelText:"İptal",okType:"danger",onOk:()=>(l.id,n(null,null,function*(){try{d.success("Kullanıcı silindi"),Ne()}catch(e){d.error("Kullanıcı silinemedi")}}))})}}];return o.jsx(_,{menu:{items:r},trigger:["click"],children:o.jsx(u,{type:"text",icon:o.jsx(J,{})})})}}],Ke=e.filter(e=>{const l=e.fullName.toLowerCase().includes(de.toLowerCase())||e.email.toLowerCase().includes(de.toLowerCase()),r="all"===me||e.role===me,a="all"===xe||("active"===xe?e.isActive:!e.isActive);return l&&r&&a});return o.jsxs("div",{className:"tenant-users-page",children:[o.jsx(Q,{title:"Kullanıcı Yönetimi",subtitle:`Toplam ${e.length} kullanıcı`,breadcrumbs:[{title:"Ana Sayfa",path:"/app/tenant"},{title:"Kullanıcılar"}],extra:o.jsxs(m,{children:[o.jsx(u,{icon:o.jsx(x,{}),children:"Dışa Aktar"}),o.jsx(u,{type:"primary",icon:o.jsx(h,{}),onClick:()=>{Ae(null),we.resetFields(),ye(!0)},children:"Yeni Kullanıcı"})]})}),o.jsxs(j,{gutter:16,style:{marginBottom:24},children:[o.jsx(p,{xs:24,sm:12,md:6,children:o.jsx(f,{children:o.jsx(y,{title:"Toplam Kullanıcı",value:e.length,prefix:o.jsx(v,{})})})}),o.jsx(p,{xs:24,sm:12,md:6,children:o.jsx(f,{children:o.jsx(y,{title:"Aktif Kullanıcı",value:e.filter(e=>e.isActive).length,prefix:o.jsx(b,{}),valueStyle:{color:"#52c41a"}})})}),o.jsx(p,{xs:24,sm:12,md:6,children:o.jsx(f,{children:o.jsx(y,{title:"Yönetici",value:e.filter(e=>"Admin"===e.role).length,prefix:o.jsx(g,{}),valueStyle:{color:"#1890ff"}})})}),o.jsx(p,{xs:24,sm:12,md:6,children:o.jsx(f,{children:o.jsx(y,{title:"Son 7 Gün Giriş",value:e.filter(e=>{if(!e.lastLogin)return!1;const l=new Date(e.lastLogin),r=new Date;return r.setDate(r.getDate()-7),l>r}).length,prefix:o.jsx(k,{})})})})]}),o.jsx(f,{style:{marginBottom:24},children:o.jsxs(j,{gutter:16,children:[o.jsx(p,{xs:24,sm:12,md:8,children:o.jsx(S,{placeholder:"Ad, soyad veya email ile ara...",prefix:o.jsx(A,{}),value:de,onChange:e=>oe(e.target.value),allowClear:!0})}),o.jsx(p,{xs:24,sm:12,md:8,children:o.jsxs(w,{style:{width:"100%"},placeholder:"Rol Seçin",value:me,onChange:ue,children:[o.jsx(te,{value:"all",children:"Tüm Roller"}),o.jsx(te,{value:"Admin",children:"Yönetici"}),o.jsx(te,{value:"Accountant",children:"Muhasebe"}),o.jsx(te,{value:"Sales",children:"Satış"}),o.jsx(te,{value:"Staff",children:"Personel"})]})}),o.jsx(p,{xs:24,sm:12,md:8,children:o.jsxs(w,{style:{width:"100%"},placeholder:"Durum Seçin",value:xe,onChange:he,children:[o.jsx(te,{value:"all",children:"Tüm Durumlar"}),o.jsx(te,{value:"active",children:"Aktif"}),o.jsx(te,{value:"inactive",children:"Pasif"})]})})]})}),o.jsx(f,{children:o.jsx(T,{columns:ze,dataSource:Ke,rowKey:"id",loading:se,scroll:{x:1200},pagination:{showSizeChanger:!0,showTotal:e=>`Toplam ${e} kullanıcı`}})}),o.jsx(D,{title:Se?"Kullanıcı Düzenle":"Yeni Kullanıcı",open:fe,onOk:()=>n(null,null,function*(){try{const e=yield we.validateFields();Se?d.success("Kullanıcı güncellendi"):(d.success("Kullanıcı oluşturuldu"),e.sendWelcomeEmail&&d.info("Hoşgeldin e-postası gönderildi")),ye(!1),we.resetFields(),Ne()}catch(e){}}),onCancel:()=>{ye(!1),we.resetFields()},width:700,okText:Se?"Güncelle":"Oluştur",cancelText:"İptal",children:o.jsxs(c,{form:we,layout:"vertical",initialValues:{role:"Staff",isActive:!0,sendWelcomeEmail:!0},children:[o.jsxs(j,{gutter:16,children:[o.jsx(p,{span:12,children:o.jsx(c.Item,{name:"firstName",label:"Ad",rules:[re.required("Ad zorunludur")],children:o.jsx(S,{placeholder:"Ad"})})}),o.jsx(p,{span:12,children:o.jsx(c.Item,{name:"lastName",label:"Soyad",rules:[re.required("Soyad zorunludur")],children:o.jsx(S,{placeholder:"Soyad"})})})]}),o.jsxs(j,{gutter:16,children:[o.jsx(p,{span:12,children:o.jsx(c.Item,{name:"email",label:"E-posta",rules:[re.required("E-posta zorunludur"),re.email("Geçerli bir e-posta giriniz")],children:o.jsx(S,{prefix:o.jsx(N,{}),placeholder:"ornek@email.com"})})}),o.jsx(p,{span:12,children:o.jsx(c.Item,{name:"phoneNumber",label:"Telefon",rules:[re.phone()],children:o.jsx(S,{prefix:o.jsx(Y,{}),placeholder:"+90 5XX XXX XX XX"})})})]}),o.jsxs(j,{gutter:16,children:[o.jsx(p,{span:12,children:o.jsx(c.Item,{name:"role",label:"Rol",rules:[re.required("Rol zorunludur")],children:o.jsxs(w,{children:[o.jsx(te,{value:"Admin",children:"Yönetici"}),o.jsx(te,{value:"Accountant",children:"Muhasebe"}),o.jsx(te,{value:"Sales",children:"Satış"}),o.jsx(te,{value:"Staff",children:"Personel"})]})})}),o.jsx(p,{span:12,children:o.jsx(c.Item,{name:"department",label:"Departman",children:o.jsx(S,{placeholder:"Departman"})})})]}),o.jsx(c.Item,{name:"title",label:"Ünvan",children:o.jsx(S,{placeholder:"Ünvan"})}),!Se&&o.jsxs(o.Fragment,{children:[o.jsx(P,{}),o.jsxs(j,{gutter:16,children:[o.jsx(p,{span:12,children:o.jsx(c.Item,{name:"password",label:"Şifre",rules:[re.required("Şifre zorunludur"),re.min(8,"En az 8 karakter olmalıdır")],children:o.jsx(S.Password,{placeholder:"Şifre"})})}),o.jsx(p,{span:12,children:o.jsx(c.Item,{name:"confirmPassword",label:"Şifre Tekrar",dependencies:["password"],rules:[re.required("Şifre tekrarı zorunludur"),({getFieldValue:e})=>({validator:(l,r)=>r&&e("password")!==r?Promise.reject(new Error("Şifreler eşleşmiyor")):Promise.resolve()})],children:o.jsx(S.Password,{placeholder:"Şifre Tekrar"})})})]}),o.jsxs(c.Item,{name:"sendWelcomeEmail",valuePropName:"checked",children:[o.jsx(I,{})," Hoşgeldin e-postası gönder"]})]})]})}),o.jsxs(D,{title:"Şifre Değiştir",open:ge,onOk:()=>Te.submit(),onCancel:()=>{ke(!1),Te.resetFields()},okText:"Değiştir",cancelText:"İptal",children:[o.jsx(z,{message:`${null==je?void 0:je.fullName} için yeni şifre belirleyin`,type:"info",showIcon:!0,style:{marginBottom:16}}),o.jsxs(c,{form:Te,layout:"vertical",onFinish:e=>n(null,null,function*(){try{d.success("Şifre güncellendi"),ke(!1),Te.resetFields()}catch(e){d.error("Şifre güncellenemedi")}}),children:[o.jsx(c.Item,{name:"newPassword",label:"Yeni Şifre",rules:[re.required("Yeni şifre zorunludur"),re.min(8,"En az 8 karakter olmalıdır")],children:o.jsx(S.Password,{placeholder:"Yeni şifre"})}),o.jsx(c.Item,{name:"confirmPassword",label:"Yeni Şifre Tekrar",dependencies:["newPassword"],rules:[re.required("Şifre tekrarı zorunludur"),({getFieldValue:e})=>({validator:(l,r)=>r&&e("newPassword")!==r?Promise.reject(new Error("Şifreler eşleşmiyor")):Promise.resolve()})],children:o.jsx(S.Password,{placeholder:"Yeni şifre tekrar"})})]})]}),o.jsx(D,{title:"Kullanıcı Detayları",open:ve,onCancel:()=>be(!1),footer:[o.jsx(u,{onClick:()=>be(!1),children:"Kapat"},"close"),o.jsx(u,{type:"primary",icon:o.jsx(V,{}),onClick:()=>{be(!1),Ye(je)},children:"Düzenle"},"edit")],width:700,children:je&&o.jsxs(K,{defaultActiveKey:"1",children:[o.jsx(ne,{tab:"Genel Bilgiler",children:o.jsxs(C,{bordered:!0,column:2,children:[o.jsx(C.Item,{label:"Ad Soyad",span:2,children:o.jsxs(m,{children:[o.jsxs(F,{style:{backgroundColor:"#667eea"},children:[je.firstName[0],je.lastName[0]]}),je.fullName]})}),o.jsxs(C.Item,{label:"E-posta",children:[je.email,je.emailVerified?o.jsx(b,{style:{color:"#52c41a",marginLeft:8}}):o.jsx(M,{style:{color:"#faad14",marginLeft:8}})]}),o.jsx(C.Item,{label:"Telefon",children:ee(je.phoneNumber)||"-"}),o.jsx(C.Item,{label:"Rol",children:o.jsx(L,{color:Pe(je.role),children:je.role})}),o.jsx(C.Item,{label:"Departman",children:je.department||"-"}),o.jsx(C.Item,{label:"Ünvan",children:je.title||"-"}),o.jsx(C.Item,{label:"Durum",children:Ie(je.isActive)}),o.jsx(C.Item,{label:"Kayıt Tarihi",children:le(je.createdAt)}),o.jsx(C.Item,{label:"Son Giriş",children:je.lastLogin?le(je.lastLogin,"DD.MM.YYYY HH:mm"):"-"})]})},"1"),o.jsxs(ne,{tab:"Yetkiler",children:[o.jsx(ae,{level:5,children:"Rol Yetkileri"}),o.jsx(E,{dataSource:je.permissions||[],renderItem:e=>o.jsx(E.Item,{children:o.jsxs(m,{children:[o.jsx(b,{style:{color:"#52c41a"}}),o.jsx(ie,{children:e})]})}),locale:{emptyText:"Yetki tanımlanmamış"}})]},"2"),o.jsx(ne,{tab:"Aktivite Geçmişi",children:o.jsx(G,{items:[{color:"green",children:o.jsxs(o.Fragment,{children:[o.jsx(ie,{strong:!0,children:"Son giriş yapıldı"}),o.jsx("div",{children:o.jsx(ie,{type:"secondary",style:{fontSize:12},children:je.lastLogin?le(je.lastLogin,"DD.MM.YYYY HH:mm"):"-"})})]})},{color:"blue",children:o.jsxs(o.Fragment,{children:[o.jsx(ie,{strong:!0,children:"Profil güncellendi"}),o.jsx("div",{children:o.jsx(ie,{type:"secondary",style:{fontSize:12},children:"10.01.2024 14:30"})})]})},{color:"gray",children:o.jsxs(o.Fragment,{children:[o.jsx(ie,{strong:!0,children:"Hesap oluşturuldu"}),o.jsx("div",{children:o.jsx(ie,{type:"secondary",style:{fontSize:12},children:le(je.createdAt)})})]})}]})},"3")]})})]})};export{ce as TenantUsers,ce as default};
