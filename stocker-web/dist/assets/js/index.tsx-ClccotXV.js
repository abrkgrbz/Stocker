var e=Object.defineProperty,l=Object.defineProperties,r=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,t=(l,r,i)=>r in l?e(l,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):l[r]=i,n=(e,l,r)=>new Promise((i,s)=>{var a=e=>{try{n(r.next(e))}catch(l){s(l)}},t=e=>{try{n(r.throw(e))}catch(l){s(l)}},n=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,t);n((r=r.apply(e,l)).next())});import{al as c,ar as o,j as d,S as m,v as u,b4 as x,bx as h,L as j,M as p,N as f,aW as y,i as v,_ as b,R as g,a5 as k,am as S,ba as A,b1 as w,aZ as N,aR as D,ao as T,a9 as Y,Y as I,bd as P,u as z,aN as K,bc as C,A as F,aI as L,T as M,E,Z as O,a_ as G,b8 as V,e as H,aJ as R,b5 as X,bg as q,I as B,bh as W,b9 as $,D as Z,bf as _,B as J}from"./chunk-CUCWWrQt.js";import{r as U}from"./chunk-nBmrMGrr.js";import{P as Q}from"./chunk-C7o7e85z.js";import{b as ee,f as le}from"./chunk-CCTZOhNJ.js";import{f as re}from"./chunk-CZ40riKv.js";import"../index-D8hn_cKL.js";import"./chunk-BsETiAjl.js";const{Title:ie,Text:se,Paragraph:ae}=E,{Option:te}=w,{TabPane:ne}=K,ce=()=>{const[e,E]=U.useState([]),[ae,ce]=U.useState(!1),[oe,de]=U.useState(""),[me,ue]=U.useState("all"),[xe,he]=U.useState("all"),[je,pe]=U.useState(null),[fe,ye]=U.useState(!1),[ve,be]=U.useState(!1),[ge,ke]=U.useState(!1),[Se,Ae]=U.useState(null),[we]=c.useForm(),[Ne]=c.useForm(),De=[{id:"1",email:"admin@company.com",firstName:"Ahmet",lastName:"Yılmaz",fullName:"Ahmet Yılmaz",phoneNumber:"+90 532 111 2233",role:"Admin",department:"Yönetim",title:"Genel Müdür",isActive:!0,emailVerified:!0,lastLogin:"2024-01-15T10:30:00",createdAt:"2023-06-01T00:00:00",permissions:["users.create","users.edit","users.delete","invoices.*","settings.*"]},{id:"2",email:"muhasebe@company.com",firstName:"Ayşe",lastName:"Demir",fullName:"Ayşe Demir",phoneNumber:"+90 533 444 5566",role:"Accountant",department:"Muhasebe",title:"Muhasebe Uzmanı",isActive:!0,emailVerified:!0,lastLogin:"2024-01-15T09:15:00",createdAt:"2023-07-15T00:00:00",permissions:["invoices.*","reports.view"]},{id:"3",email:"satis@company.com",firstName:"Mehmet",lastName:"Kaya",fullName:"Mehmet Kaya",phoneNumber:"+90 534 777 8899",role:"Sales",department:"Satış",title:"Satış Temsilcisi",isActive:!0,emailVerified:!1,lastLogin:"2024-01-14T16:45:00",createdAt:"2023-09-01T00:00:00",permissions:["customers.*","orders.create","orders.view"]},{id:"4",email:"depo@company.com",firstName:"Fatma",lastName:"Öz",fullName:"Fatma Öz",phoneNumber:"+90 535 222 3344",role:"Staff",department:"Depo",title:"Depo Sorumlusu",isActive:!1,emailVerified:!0,lastLogin:"2024-01-10T11:20:00",createdAt:"2023-10-01T00:00:00",permissions:["inventory.*"]}];U.useEffect(()=>{Te()},[]);const Te=()=>n(null,null,function*(){ce(!0);try{setTimeout(()=>{E(De),ce(!1)},1e3)}catch(e){o.error("Kullanıcılar yüklenemedi"),ce(!1)}}),Ye=e=>{var n;Ae(e),we.setFieldsValue((n=((e,l)=>{for(var r in l||(l={}))s.call(l,r)&&t(e,r,l[r]);if(i)for(var r of i(l))a.call(l,r)&&t(e,r,l[r]);return e})({},e),l(n,r({sendWelcomeEmail:!1})))),ye(!0)},Ie=e=>({Admin:"red",Accountant:"blue",Sales:"green",Staff:"default",Manager:"purple"}[e]||"default"),Pe=e=>e?d.jsx(J,{status:"success",text:"Aktif"}):d.jsx(J,{status:"error",text:"Pasif"}),ze=[{title:"Kullanıcı",key:"user",fixed:"left",width:280,render:(e,l)=>d.jsxs(m,{children:[d.jsxs(F,{size:40,style:{backgroundColor:"#667eea"},icon:d.jsx(H,{}),children:[l.firstName[0],l.lastName[0]]}),d.jsxs("div",{children:[d.jsxs("div",{children:[d.jsx(se,{strong:!0,children:l.fullName}),!l.emailVerified&&d.jsx(R,{title:"E-posta doğrulanmamış",children:d.jsx(L,{style:{color:"#faad14",marginLeft:8}})})]}),d.jsx(se,{type:"secondary",style:{fontSize:12},children:l.email})]})]})},{title:"Rol",dataIndex:"role",key:"role",width:120,filters:[{text:"Admin",value:"Admin"},{text:"Muhasebe",value:"Accountant"},{text:"Satış",value:"Sales"},{text:"Personel",value:"Staff"}],render:e=>d.jsx(M,{color:Ie(e),children:"Admin"===e?"Yönetici":"Accountant"===e?"Muhasebe":"Sales"===e?"Satış":"Staff"===e?"Personel":e})},{title:"Departman",dataIndex:"department",key:"department",width:120,render:e=>e||"-"},{title:"Ünvan",dataIndex:"title",key:"title",width:150,ellipsis:!0,render:e=>e||"-"},{title:"Telefon",dataIndex:"phoneNumber",key:"phoneNumber",width:140,render:e=>ee(e)||"-"},{title:"Son Giriş",dataIndex:"lastLogin",key:"lastLogin",width:150,sorter:!0,render:e=>e?d.jsx(R,{title:le(e,"DD.MM.YYYY HH:mm"),children:le(e,"DD.MM.YYYY")}):"-"},{title:"Durum",dataIndex:"isActive",key:"isActive",width:100,filters:[{text:"Aktif",value:!0},{text:"Pasif",value:!1}],render:e=>Pe(e)},{title:"İşlemler",key:"actions",fixed:"right",width:120,render:(e,l)=>{const r=[{key:"view",label:"Detayları Gör",icon:d.jsx(X,{}),onClick:()=>(pe(l),void be(!0))},{key:"edit",label:"Düzenle",icon:d.jsx(V,{}),onClick:()=>Ye(l)},{key:"password",label:"Şifre Değiştir",icon:d.jsx(q,{}),onClick:()=>(pe(l),Ne.resetFields(),void ke(!0))},{type:"divider"},{key:"toggle",label:l.isActive?"Pasifleştir":"Aktifleştir",icon:l.isActive?d.jsx(B,{}):d.jsx(W,{}),onClick:()=>{return l.id,e=!l.isActive,n(null,null,function*(){try{o.success(e?"Kullanıcı aktifleştirildi":"Kullanıcı pasifleştirildi"),Te()}catch(l){o.error("İşlem başarısız")}});var e}},{key:"delete",label:"Sil",icon:d.jsx($,{}),danger:!0,onClick:()=>{D.confirm({title:"Kullanıcıyı Sil",content:`${l.fullName} adlı kullanıcıyı silmek istediğinizden emin misiniz?`,okText:"Sil",cancelText:"İptal",okType:"danger",onOk:()=>(l.id,n(null,null,function*(){try{o.success("Kullanıcı silindi"),Te()}catch(e){o.error("Kullanıcı silinemedi")}}))})}}];return d.jsx(Z,{menu:{items:r},trigger:["click"],children:d.jsx(u,{type:"text",icon:d.jsx(_,{})})})}}],Ke=e.filter(e=>{const l=e.fullName.toLowerCase().includes(oe.toLowerCase())||e.email.toLowerCase().includes(oe.toLowerCase()),r="all"===me||e.role===me,i="all"===xe||("active"===xe?e.isActive:!e.isActive);return l&&r&&i});return d.jsxs("div",{className:"tenant-users-page",children:[d.jsx(Q,{title:"Kullanıcı Yönetimi",subtitle:`Toplam ${e.length} kullanıcı`,breadcrumbs:[{title:"Ana Sayfa",path:"/app/tenant"},{title:"Kullanıcılar"}],extra:d.jsxs(m,{children:[d.jsx(u,{icon:d.jsx(x,{}),children:"Dışa Aktar"}),d.jsx(u,{type:"primary",icon:d.jsx(h,{}),onClick:()=>{Ae(null),we.resetFields(),ye(!0)},children:"Yeni Kullanıcı"})]})}),d.jsxs(j,{gutter:16,style:{marginBottom:24},children:[d.jsx(p,{xs:24,sm:12,md:6,children:d.jsx(f,{children:d.jsx(y,{title:"Toplam Kullanıcı",value:e.length,prefix:d.jsx(v,{})})})}),d.jsx(p,{xs:24,sm:12,md:6,children:d.jsx(f,{children:d.jsx(y,{title:"Aktif Kullanıcı",value:e.filter(e=>e.isActive).length,prefix:d.jsx(b,{}),valueStyle:{color:"#52c41a"}})})}),d.jsx(p,{xs:24,sm:12,md:6,children:d.jsx(f,{children:d.jsx(y,{title:"Yönetici",value:e.filter(e=>"Admin"===e.role).length,prefix:d.jsx(g,{}),valueStyle:{color:"#1890ff"}})})}),d.jsx(p,{xs:24,sm:12,md:6,children:d.jsx(f,{children:d.jsx(y,{title:"Son 7 Gün Giriş",value:e.filter(e=>{if(!e.lastLogin)return!1;const l=new Date(e.lastLogin),r=new Date;return r.setDate(r.getDate()-7),l>r}).length,prefix:d.jsx(k,{})})})})]}),d.jsx(f,{style:{marginBottom:24},children:d.jsxs(j,{gutter:16,children:[d.jsx(p,{xs:24,sm:12,md:8,children:d.jsx(S,{placeholder:"Ad, soyad veya email ile ara...",prefix:d.jsx(A,{}),value:oe,onChange:e=>de(e.target.value),allowClear:!0})}),d.jsx(p,{xs:24,sm:12,md:8,children:d.jsxs(w,{style:{width:"100%"},placeholder:"Rol Seçin",value:me,onChange:ue,children:[d.jsx(te,{value:"all",children:"Tüm Roller"}),d.jsx(te,{value:"Admin",children:"Yönetici"}),d.jsx(te,{value:"Accountant",children:"Muhasebe"}),d.jsx(te,{value:"Sales",children:"Satış"}),d.jsx(te,{value:"Staff",children:"Personel"})]})}),d.jsx(p,{xs:24,sm:12,md:8,children:d.jsxs(w,{style:{width:"100%"},placeholder:"Durum Seçin",value:xe,onChange:he,children:[d.jsx(te,{value:"all",children:"Tüm Durumlar"}),d.jsx(te,{value:"active",children:"Aktif"}),d.jsx(te,{value:"inactive",children:"Pasif"})]})})]})}),d.jsx(f,{children:d.jsx(N,{columns:ze,dataSource:Ke,rowKey:"id",loading:ae,scroll:{x:1200},pagination:{showSizeChanger:!0,showTotal:e=>`Toplam ${e} kullanıcı`}})}),d.jsx(D,{title:Se?"Kullanıcı Düzenle":"Yeni Kullanıcı",open:fe,onOk:()=>n(null,null,function*(){try{const e=yield we.validateFields();Se?o.success("Kullanıcı güncellendi"):(o.success("Kullanıcı oluşturuldu"),e.sendWelcomeEmail&&o.info("Hoşgeldin e-postası gönderildi")),ye(!1),we.resetFields(),Te()}catch(e){}}),onCancel:()=>{ye(!1),we.resetFields()},width:700,okText:Se?"Güncelle":"Oluştur",cancelText:"İptal",children:d.jsxs(c,{form:we,layout:"vertical",initialValues:{role:"Staff",isActive:!0,sendWelcomeEmail:!0},children:[d.jsxs(j,{gutter:16,children:[d.jsx(p,{span:12,children:d.jsx(c.Item,{name:"firstName",label:"Ad",rules:[re.required("Ad zorunludur")],children:d.jsx(S,{placeholder:"Ad"})})}),d.jsx(p,{span:12,children:d.jsx(c.Item,{name:"lastName",label:"Soyad",rules:[re.required("Soyad zorunludur")],children:d.jsx(S,{placeholder:"Soyad"})})})]}),d.jsxs(j,{gutter:16,children:[d.jsx(p,{span:12,children:d.jsx(c.Item,{name:"email",label:"E-posta",rules:[re.required("E-posta zorunludur"),re.email("Geçerli bir e-posta giriniz")],children:d.jsx(S,{prefix:d.jsx(T,{}),placeholder:"ornek@email.com"})})}),d.jsx(p,{span:12,children:d.jsx(c.Item,{name:"phoneNumber",label:"Telefon",rules:[re.phone()],children:d.jsx(S,{prefix:d.jsx(Y,{}),placeholder:"+90 5XX XXX XX XX"})})})]}),d.jsxs(j,{gutter:16,children:[d.jsx(p,{span:12,children:d.jsx(c.Item,{name:"role",label:"Rol",rules:[re.required("Rol zorunludur")],children:d.jsxs(w,{children:[d.jsx(te,{value:"Admin",children:"Yönetici"}),d.jsx(te,{value:"Accountant",children:"Muhasebe"}),d.jsx(te,{value:"Sales",children:"Satış"}),d.jsx(te,{value:"Staff",children:"Personel"})]})})}),d.jsx(p,{span:12,children:d.jsx(c.Item,{name:"department",label:"Departman",children:d.jsx(S,{placeholder:"Departman"})})})]}),d.jsx(c.Item,{name:"title",label:"Ünvan",children:d.jsx(S,{placeholder:"Ünvan"})}),!Se&&d.jsxs(d.Fragment,{children:[d.jsx(I,{}),d.jsxs(j,{gutter:16,children:[d.jsx(p,{span:12,children:d.jsx(c.Item,{name:"password",label:"Şifre",rules:[re.required("Şifre zorunludur"),re.min(8,"En az 8 karakter olmalıdır")],children:d.jsx(S.Password,{placeholder:"Şifre"})})}),d.jsx(p,{span:12,children:d.jsx(c.Item,{name:"confirmPassword",label:"Şifre Tekrar",dependencies:["password"],rules:[re.required("Şifre tekrarı zorunludur"),({getFieldValue:e})=>({validator:(l,r)=>r&&e("password")!==r?Promise.reject(new Error("Şifreler eşleşmiyor")):Promise.resolve()})],children:d.jsx(S.Password,{placeholder:"Şifre Tekrar"})})})]}),d.jsxs(c.Item,{name:"sendWelcomeEmail",valuePropName:"checked",children:[d.jsx(P,{})," Hoşgeldin e-postası gönder"]})]})]})}),d.jsxs(D,{title:"Şifre Değiştir",open:ge,onOk:()=>Ne.submit(),onCancel:()=>{ke(!1),Ne.resetFields()},okText:"Değiştir",cancelText:"İptal",children:[d.jsx(z,{message:`${null==je?void 0:je.fullName} için yeni şifre belirleyin`,type:"info",showIcon:!0,style:{marginBottom:16}}),d.jsxs(c,{form:Ne,layout:"vertical",onFinish:e=>n(null,null,function*(){try{o.success("Şifre güncellendi"),ke(!1),Ne.resetFields()}catch(e){o.error("Şifre güncellenemedi")}}),children:[d.jsx(c.Item,{name:"newPassword",label:"Yeni Şifre",rules:[re.required("Yeni şifre zorunludur"),re.min(8,"En az 8 karakter olmalıdır")],children:d.jsx(S.Password,{placeholder:"Yeni şifre"})}),d.jsx(c.Item,{name:"confirmPassword",label:"Yeni Şifre Tekrar",dependencies:["newPassword"],rules:[re.required("Şifre tekrarı zorunludur"),({getFieldValue:e})=>({validator:(l,r)=>r&&e("newPassword")!==r?Promise.reject(new Error("Şifreler eşleşmiyor")):Promise.resolve()})],children:d.jsx(S.Password,{placeholder:"Yeni şifre tekrar"})})]})]}),d.jsx(D,{title:"Kullanıcı Detayları",open:ve,onCancel:()=>be(!1),footer:[d.jsx(u,{onClick:()=>be(!1),children:"Kapat"},"close"),d.jsx(u,{type:"primary",icon:d.jsx(V,{}),onClick:()=>{be(!1),Ye(je)},children:"Düzenle"},"edit")],width:700,children:je&&d.jsxs(K,{defaultActiveKey:"1",children:[d.jsx(ne,{tab:"Genel Bilgiler",children:d.jsxs(C,{bordered:!0,column:2,children:[d.jsx(C.Item,{label:"Ad Soyad",span:2,children:d.jsxs(m,{children:[d.jsxs(F,{style:{backgroundColor:"#667eea"},children:[je.firstName[0],je.lastName[0]]}),je.fullName]})}),d.jsxs(C.Item,{label:"E-posta",children:[je.email,je.emailVerified?d.jsx(b,{style:{color:"#52c41a",marginLeft:8}}):d.jsx(L,{style:{color:"#faad14",marginLeft:8}})]}),d.jsx(C.Item,{label:"Telefon",children:ee(je.phoneNumber)||"-"}),d.jsx(C.Item,{label:"Rol",children:d.jsx(M,{color:Ie(je.role),children:je.role})}),d.jsx(C.Item,{label:"Departman",children:je.department||"-"}),d.jsx(C.Item,{label:"Ünvan",children:je.title||"-"}),d.jsx(C.Item,{label:"Durum",children:Pe(je.isActive)}),d.jsx(C.Item,{label:"Kayıt Tarihi",children:le(je.createdAt)}),d.jsx(C.Item,{label:"Son Giriş",children:je.lastLogin?le(je.lastLogin,"DD.MM.YYYY HH:mm"):"-"})]})},"1"),d.jsxs(ne,{tab:"Yetkiler",children:[d.jsx(ie,{level:5,children:"Rol Yetkileri"}),d.jsx(O,{dataSource:je.permissions||[],renderItem:e=>d.jsx(O.Item,{children:d.jsxs(m,{children:[d.jsx(b,{style:{color:"#52c41a"}}),d.jsx(se,{children:e})]})}),locale:{emptyText:"Yetki tanımlanmamış"}})]},"2"),d.jsx(ne,{tab:"Aktivite Geçmişi",children:d.jsx(G,{items:[{color:"green",children:d.jsxs(d.Fragment,{children:[d.jsx(se,{strong:!0,children:"Son giriş yapıldı"}),d.jsx("div",{children:d.jsx(se,{type:"secondary",style:{fontSize:12},children:je.lastLogin?le(je.lastLogin,"DD.MM.YYYY HH:mm"):"-"})})]})},{color:"blue",children:d.jsxs(d.Fragment,{children:[d.jsx(se,{strong:!0,children:"Profil güncellendi"}),d.jsx("div",{children:d.jsx(se,{type:"secondary",style:{fontSize:12},children:"10.01.2024 14:30"})})]})},{color:"gray",children:d.jsxs(d.Fragment,{children:[d.jsx(se,{strong:!0,children:"Hesap oluşturuldu"}),d.jsx("div",{children:d.jsx(se,{type:"secondary",style:{fontSize:12},children:le(je.createdAt)})})]})}]})},"3")]})})]})};export{ce as TenantUsers,ce as default};
