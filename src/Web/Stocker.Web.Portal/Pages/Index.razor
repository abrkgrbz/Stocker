@page "/"
@inject IHttpContextAccessor HttpContextAccessor
@inject IConfiguration Configuration

<PageTitle>Index</PageTitle>

<h1>Hello, world!</h1>

Welcome to your new app.

<div class="alert alert-info mt-4">
    <h4>Debug Information:</h4>
    <p><strong>Current Host:</strong> @currentHost</p>
    <p><strong>Extracted Subdomain:</strong> @extractedSubdomain</p>
    <p><strong>Base Domain:</strong> @baseDomain</p>
</div>

<SurveyPrompt Title="How is Blazor working for you?" />

@code {
    private string currentHost = "Unknown";
    private string extractedSubdomain = "None";
    private string baseDomain = "stocker.local";

    protected override void OnInitialized()
    {
        baseDomain = Configuration["TenantSettings:BaseDomain"] ?? "stocker.local";
        currentHost = HttpContextAccessor.HttpContext?.Request.Host.Host ?? "Unknown";
        
        if (!string.IsNullOrEmpty(currentHost) && currentHost.Contains(baseDomain))
        {
            var subdomain = currentHost.Replace($".{baseDomain}", "", StringComparison.OrdinalIgnoreCase);
            
            // Port numarasını kaldır
            var portIndex = subdomain.IndexOf(':');
            if (portIndex > 0)
            {
                subdomain = subdomain.Substring(0, portIndex);
            }
            
            if (!string.IsNullOrEmpty(subdomain) && subdomain != baseDomain)
            {
                extractedSubdomain = subdomain;
            }
        }
    }
}
